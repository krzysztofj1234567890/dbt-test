[0m20:04:05.563964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce93d6d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce921a6740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce921a6710>]}


============================== 20:04:05.577381 | bd5ee500-7234-46a3-a1e3-57be60efdee2 ==============================
[0m20:04:05.577381 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:04:05.578102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kj/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:05.578621 [info ] [MainThread]: dbt version: 1.6.6
[0m20:04:05.579122 [info ] [MainThread]: python version: 3.10.12
[0m20:04:05.579588 [info ] [MainThread]: python path: /usr/bin/python3
[0m20:04:05.580072 [info ] [MainThread]: os info: Linux-6.2.0-34-generic-x86_64-with-glibc2.35
[0m20:04:05.891501 [info ] [MainThread]: Using profiles dir at /home/kj/.dbt
[0m20:04:05.892124 [info ] [MainThread]: Using profiles.yml file at /home/kj/.dbt/profiles.yml
[0m20:04:05.892610 [info ] [MainThread]: Using dbt_project.yml file at /home/kj/Krzys/git/dbt-test/dbt_test_snow/dbt_project.yml
[0m20:04:05.893282 [info ] [MainThread]: adapter type: snowflake
[0m20:04:05.893759 [info ] [MainThread]: adapter version: 1.6.4
[0m20:04:05.920494 [info ] [MainThread]: Configuration:
[0m20:04:05.921156 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:04:05.921689 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:04:05.922277 [info ] [MainThread]: Required dependencies:
[0m20:04:05.922742 [debug] [MainThread]: Executing "git --help"
[0m20:04:05.926244 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:04:05.926835 [debug] [MainThread]: STDERR: "b''"
[0m20:04:05.927316 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:04:05.927825 [info ] [MainThread]: Connection:
[0m20:04:05.928346 [info ] [MainThread]:   account: cifynsh-gya10556
[0m20:04:05.928829 [info ] [MainThread]:   user: transform_user
[0m20:04:05.929320 [info ] [MainThread]:   database: ANALYTICS
[0m20:04:05.929796 [info ] [MainThread]:   warehouse: TRANSFORM_WH
[0m20:04:05.930380 [info ] [MainThread]:   role: TRANSFORM_ROLE
[0m20:04:05.930880 [info ] [MainThread]:   schema: dbt
[0m20:04:05.931376 [info ] [MainThread]:   authenticator: None
[0m20:04:05.931848 [info ] [MainThread]:   private_key_path: None
[0m20:04:05.932345 [info ] [MainThread]:   token: None
[0m20:04:05.933670 [info ] [MainThread]:   oauth_client_id: None
[0m20:04:05.935366 [info ] [MainThread]:   query_tag: None
[0m20:04:05.936031 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:04:05.938204 [info ] [MainThread]:   host: None
[0m20:04:05.938905 [info ] [MainThread]:   port: None
[0m20:04:05.939371 [info ] [MainThread]:   proxy_host: None
[0m20:04:05.940083 [info ] [MainThread]:   proxy_port: None
[0m20:04:05.940648 [info ] [MainThread]:   protocol: None
[0m20:04:05.941189 [info ] [MainThread]:   connect_retries: 1
[0m20:04:05.941851 [info ] [MainThread]:   connect_timeout: None
[0m20:04:05.942469 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:04:05.958170 [info ] [MainThread]:   retry_all: False
[0m20:04:05.958875 [info ] [MainThread]:   insecure_mode: False
[0m20:04:05.959488 [info ] [MainThread]:   reuse_connections: None
[0m20:04:05.960128 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:04:05.961055 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:04:05.962018 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:04:05.962737 [debug] [MainThread]: On debug: select 1 as id
[0m20:04:05.963288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:07.790834 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:04:07.792753 [debug] [MainThread]: On debug: Close
[0m20:04:08.010563 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:04:08.012202 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:04:08.013860 [debug] [MainThread]: Command `dbt debug` succeeded at 20:04:08.013563 after 2.46 seconds
[0m20:04:08.015027 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:04:08.016093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce93d6d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce915d6fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8c9236a0>]}
[0m20:04:08.017220 [debug] [MainThread]: Flushing usage events
[0m20:04:39.128655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf2e71de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf13ae4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf13aefb0>]}


============================== 20:04:39.133026 | 8e6332aa-7d5d-4a33-9ead-76b566126ad3 ==============================
[0m20:04:39.133026 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:04:39.133661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:39.356456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e6332aa-7d5d-4a33-9ead-76b566126ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf13ae5f0>]}
[0m20:04:39.374960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e6332aa-7d5d-4a33-9ead-76b566126ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bebe1f3d0>]}
[0m20:04:39.375765 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:04:39.384488 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:04:39.385216 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:04:39.385738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e6332aa-7d5d-4a33-9ead-76b566126ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bebe1d7b0>]}
[0m20:04:40.338263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e6332aa-7d5d-4a33-9ead-76b566126ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bebd61d80>]}
[0m20:04:40.347214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e6332aa-7d5d-4a33-9ead-76b566126ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bebd9c790>]}
[0m20:04:40.347813 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:04:40.348342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e6332aa-7d5d-4a33-9ead-76b566126ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bebdb7b20>]}
[0m20:04:40.349778 [info ] [MainThread]: 
[0m20:04:40.350699 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:04:40.352033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:04:40.366202 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:04:40.366763 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:04:40.367255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:41.365611 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:04:41.370696 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:04:41.583531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now create_ANALYTICS_dbt)
[0m20:04:41.585461 [debug] [ThreadPool]: Creating schema "database: "ANALYTICS"
schema: "dbt"
"
[0m20:04:41.596866 [debug] [ThreadPool]: Using snowflake connection "create_ANALYTICS_dbt"
[0m20:04:41.597880 [debug] [ThreadPool]: On create_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "create_ANALYTICS_dbt"} */
create schema if not exists ANALYTICS.dbt
[0m20:04:41.598984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:42.470882 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01afb804-0000-07d6-0000-00009b8330d9
[0m20:04:42.473631 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m20:04:42.475993 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m20:04:42.477159 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:04:42.479315 [debug] [ThreadPool]: On create_ANALYTICS_dbt: Close
[0m20:04:42.703102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:42.704323 [debug] [MainThread]: Connection 'create_ANALYTICS_dbt' was properly closed.
[0m20:04:42.705569 [info ] [MainThread]: 
[0m20:04:42.706918 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m20:04:42.708351 [error] [MainThread]: Encountered an error:
Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m20:04:42.709942 [debug] [MainThread]: Command `dbt run` failed at 20:04:42.709722 after 3.59 seconds
[0m20:04:42.711115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf2e71de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bebd62830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bea13f9a0>]}
[0m20:04:42.712117 [debug] [MainThread]: Flushing usage events
[0m20:12:15.928264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e34849db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e32c82440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e32c82410>]}


============================== 20:12:15.988380 | ef8ca469-92f8-4375-94cf-adb084126255 ==============================
[0m20:12:15.988380 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:12:15.989306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'profiles_dir': '/home/kj/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:12:16.558529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef8ca469-92f8-4375-94cf-adb084126255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e32c82590>]}
[0m20:12:16.613774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef8ca469-92f8-4375-94cf-adb084126255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2d8f73d0>]}
[0m20:12:16.614689 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:12:16.654239 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:12:17.058852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:12:17.059396 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:12:17.079463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef8ca469-92f8-4375-94cf-adb084126255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2d6d27d0>]}
[0m20:12:17.154003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef8ca469-92f8-4375-94cf-adb084126255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2d7f9de0>]}
[0m20:12:17.154910 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:12:17.155594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef8ca469-92f8-4375-94cf-adb084126255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2d7f9ff0>]}
[0m20:12:17.157892 [info ] [MainThread]: 
[0m20:12:17.159046 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:12:17.160723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:12:17.175744 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:12:17.176322 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:12:17.176804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:18.131148 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:12:18.132640 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:12:18.359153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now create_ANALYTICS_dbt)
[0m20:12:18.361868 [debug] [ThreadPool]: Creating schema "database: "ANALYTICS"
schema: "dbt"
"
[0m20:12:18.373997 [debug] [ThreadPool]: Using snowflake connection "create_ANALYTICS_dbt"
[0m20:12:18.375246 [debug] [ThreadPool]: On create_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "create_ANALYTICS_dbt"} */
create schema if not exists ANALYTICS.dbt
[0m20:12:18.375986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:19.149741 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01afb80c-0000-07d6-0000-00009b833129
[0m20:12:19.150251 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m20:12:19.150937 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m20:12:19.151355 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:12:19.151816 [debug] [ThreadPool]: On create_ANALYTICS_dbt: Close
[0m20:12:19.362058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:19.363722 [debug] [MainThread]: Connection 'create_ANALYTICS_dbt' was properly closed.
[0m20:12:19.364926 [info ] [MainThread]: 
[0m20:12:19.366238 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m20:12:19.367941 [error] [MainThread]: Encountered an error:
Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m20:12:19.369485 [debug] [MainThread]: Command `dbt run` failed at 20:12:19.369261 after 3.45 seconds
[0m20:12:19.370517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e34849db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2d7f9f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2ca559c0>]}
[0m20:12:19.371885 [debug] [MainThread]: Flushing usage events
[0m20:14:59.388992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9383dcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c91c763e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c91c76380>]}


============================== 20:14:59.393380 | 470b8484-eb2a-4c24-b827-df62f28d140c ==============================
[0m20:14:59.393380 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:14:59.394083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:14:59.615870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '470b8484-eb2a-4c24-b827-df62f28d140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c91c76530>]}
[0m20:14:59.634603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '470b8484-eb2a-4c24-b827-df62f28d140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8c8eb430>]}
[0m20:14:59.635568 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:14:59.644598 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:14:59.738741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:14:59.739249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:14:59.762322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '470b8484-eb2a-4c24-b827-df62f28d140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8c6c2770>]}
[0m20:15:00.238261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '470b8484-eb2a-4c24-b827-df62f28d140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8c7ddd80>]}
[0m20:15:00.239415 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:15:00.240280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '470b8484-eb2a-4c24-b827-df62f28d140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8c7ddf90>]}
[0m20:15:00.243021 [info ] [MainThread]: 
[0m20:15:00.244442 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:15:00.246506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:15:00.263695 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:15:00.264285 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:15:00.264748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:01.258903 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:15:01.260935 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:15:01.501162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m20:15:01.511636 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m20:15:01.512169 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m20:15:01.512589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:02.131748 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:15:02.134333 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m20:15:02.353761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '470b8484-eb2a-4c24-b827-df62f28d140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8c6931f0>]}
[0m20:15:02.355434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:15:02.356239 [info ] [MainThread]: 
[0m20:15:02.628120 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m20:15:02.629500 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m20:15:02.631367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.my_first_dbt_model)
[0m20:15:02.632663 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m20:15:02.750311 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:15:02.753631 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 20:15:02.633243 => 20:15:02.753182
[0m20:15:02.755362 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m20:15:02.891542 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:15:02.893990 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m20:15:02.894690 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:15:02.895269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:03.635841 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01afb80f-0000-07d8-0000-00009b83214d
[0m20:15:03.636469 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m20:15:03.637302 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 20:15:02.756261 => 20:15:03.636956
[0m20:15:03.637826 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m20:15:04.062049 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbt_test_snow/models/example/my_first_dbt_model.sql
[0m20:15:04.063978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '470b8484-eb2a-4c24-b827-df62f28d140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8c270c10>]}
[0m20:15:04.065737 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt.my_first_dbt_model ................... [[31mERROR[0m in 1.43s]
[0m20:15:04.067922 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m20:15:04.071049 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m20:15:04.073207 [info ] [Thread-1 (]: 2 of 2 SKIP relation dbt.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m20:15:04.076195 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m20:15:04.081608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:04.082930 [debug] [MainThread]: Connection 'model.dbt_test_snow.my_first_dbt_model' was properly closed.
[0m20:15:04.084002 [info ] [MainThread]: 
[0m20:15:04.085424 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m20:15:04.087499 [debug] [MainThread]: Command end result
[0m20:15:04.098831 [info ] [MainThread]: 
[0m20:15:04.099829 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:15:04.100712 [info ] [MainThread]: 
[0m20:15:04.101328 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbt_test_snow/models/example/my_first_dbt_model.sql
[0m20:15:04.102100 [info ] [MainThread]: 
[0m20:15:04.102791 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m20:15:04.103641 [debug] [MainThread]: Command `dbt run` failed at 20:15:04.103512 after 4.72 seconds
[0m20:15:04.104167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9383dcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8c8eb430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8c37db10>]}
[0m20:15:04.104698 [debug] [MainThread]: Flushing usage events
[0m20:16:15.622474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4002c3dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40010764a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4001076440>]}


============================== 20:16:15.648879 | be318b81-79e0-46d4-9cc3-73069c350806 ==============================
[0m20:16:15.648879 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:16:15.649609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'debug': 'False', 'profiles_dir': '/home/kj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:18.184254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be318b81-79e0-46d4-9cc3-73069c350806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40010765f0>]}
[0m20:16:18.204256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be318b81-79e0-46d4-9cc3-73069c350806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffbceb3d0>]}
[0m20:16:18.205191 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:16:18.214277 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:16:18.240077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:18.240660 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:18.246248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be318b81-79e0-46d4-9cc3-73069c350806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffbac6830>]}
[0m20:16:18.583307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be318b81-79e0-46d4-9cc3-73069c350806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffbbf1e40>]}
[0m20:16:18.584987 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:16:18.586608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be318b81-79e0-46d4-9cc3-73069c350806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffbbf2050>]}
[0m20:16:18.599547 [info ] [MainThread]: 
[0m20:16:18.601374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:16:18.633781 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:16:18.710979 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:16:18.711669 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:16:18.712151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:19.770301 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:16:19.772491 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:16:20.022177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m20:16:20.032808 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m20:16:20.033382 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m20:16:20.033816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:20.831000 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:16:20.835009 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m20:16:21.048532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be318b81-79e0-46d4-9cc3-73069c350806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffb9268c0>]}
[0m20:16:21.050038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:21.051276 [info ] [MainThread]: 
[0m20:16:21.056980 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m20:16:21.058432 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m20:16:21.059986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.my_first_dbt_model)
[0m20:16:21.061028 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m20:16:21.776302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:16:21.779177 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 20:16:21.061773 => 20:16:21.778297
[0m20:16:21.780301 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m20:16:21.873971 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:16:21.875877 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m20:16:21.876470 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:16:21.877059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:22.651922 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01afb810-0000-07d8-0000-00009b83216d
[0m20:16:22.654556 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m20:16:22.658021 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 20:16:21.781138 => 20:16:22.657337
[0m20:16:22.659350 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m20:16:22.960681 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbt_test_snow/models/example/my_first_dbt_model.sql
[0m20:16:22.961483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be318b81-79e0-46d4-9cc3-73069c350806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffad00340>]}
[0m20:16:22.962437 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt.my_first_dbt_model ................... [[31mERROR[0m in 1.90s]
[0m20:16:22.963395 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m20:16:22.965189 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m20:16:22.965888 [info ] [Thread-1 (]: 2 of 2 SKIP relation dbt.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m20:16:22.966745 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m20:16:22.969211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:22.969734 [debug] [MainThread]: Connection 'model.dbt_test_snow.my_first_dbt_model' was properly closed.
[0m20:16:22.970408 [info ] [MainThread]: 
[0m20:16:22.971076 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m20:16:22.972280 [debug] [MainThread]: Command end result
[0m20:16:22.981795 [info ] [MainThread]: 
[0m20:16:22.982564 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:16:22.983227 [info ] [MainThread]: 
[0m20:16:22.983792 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbt_test_snow/models/example/my_first_dbt_model.sql
[0m20:16:22.984350 [info ] [MainThread]: 
[0m20:16:22.984919 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m20:16:22.985724 [debug] [MainThread]: Command `dbt run` failed at 20:16:22.985599 after 7.37 seconds
[0m20:16:22.986357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4002c3dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffbceb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffbbf0f10>]}
[0m20:16:22.986897 [debug] [MainThread]: Flushing usage events
[0m20:17:07.351262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bee65cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bd26a440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bd26a3e0>]}


============================== 20:17:07.384615 | 3cd84f24-633f-49cc-b0a0-e18a875f015f ==============================
[0m20:17:07.384615 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:17:07.385269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'profiles_dir': '/home/kj/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:17:08.585272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cd84f24-633f-49cc-b0a0-e18a875f015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bd26a590>]}
[0m20:17:08.603449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cd84f24-633f-49cc-b0a0-e18a875f015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50b7edf280>]}
[0m20:17:08.604283 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:17:08.613072 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:17:08.642236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:17:08.642856 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:17:08.652450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cd84f24-633f-49cc-b0a0-e18a875f015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50b7cba7d0>]}
[0m20:17:08.664583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cd84f24-633f-49cc-b0a0-e18a875f015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50b7de1de0>]}
[0m20:17:08.665373 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:17:08.665995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd84f24-633f-49cc-b0a0-e18a875f015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50b7de1ff0>]}
[0m20:17:08.667670 [info ] [MainThread]: 
[0m20:17:08.668570 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:17:08.669899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:17:08.685191 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:17:08.685825 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:17:08.687200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:09.659858 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:17:09.661827 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:17:09.963212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m20:17:09.980892 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m20:17:09.981621 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m20:17:09.982554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:10.599352 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:17:10.601783 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m20:17:10.925936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd84f24-633f-49cc-b0a0-e18a875f015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50b7b080d0>]}
[0m20:17:10.927170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:17:10.927753 [info ] [MainThread]: 
[0m20:17:10.931485 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m20:17:10.932286 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m20:17:10.933335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.my_first_dbt_model)
[0m20:17:10.933927 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m20:17:10.946224 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:17:10.947290 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 20:17:10.934450 => 20:17:10.946949
[0m20:17:10.947820 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m20:17:11.266878 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:17:11.269597 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m20:17:11.270772 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:17:11.271852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:12.931536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:17:12.972993 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 20:17:10.948201 => 20:17:12.972700
[0m20:17:12.973630 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m20:17:13.304688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cd84f24-633f-49cc-b0a0-e18a875f015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50b70ed2d0>]}
[0m20:17:13.306158 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 2.37s]
[0m20:17:13.307968 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m20:17:13.310998 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m20:17:13.312214 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt.my_second_dbt_model ............................ [RUN]
[0m20:17:13.313823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.my_second_dbt_model)
[0m20:17:13.314812 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_second_dbt_model
[0m20:17:13.318326 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_second_dbt_model"
[0m20:17:13.319243 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (compile): 20:17:13.315663 => 20:17:13.319016
[0m20:17:13.319735 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_second_dbt_model
[0m20:17:13.625497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_second_dbt_model"
[0m20:17:13.627008 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_second_dbt_model"
[0m20:17:13.627484 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_second_dbt_model"} */
create or replace   view ANALYTICS.dbt.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from ANALYTICS.dbt.my_first_dbt_model
where id = 1
  );
[0m20:17:13.627949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:14.589501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:17:14.597523 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (execute): 20:17:13.320100 => 20:17:14.596909
[0m20:17:14.599090 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: Close
[0m20:17:14.834039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cd84f24-633f-49cc-b0a0-e18a875f015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50b70ee710>]}
[0m20:17:14.835961 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 1.52s]
[0m20:17:14.837991 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m20:17:14.843404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:14.844459 [debug] [MainThread]: Connection 'model.dbt_test_snow.my_second_dbt_model' was properly closed.
[0m20:17:14.845535 [info ] [MainThread]: 
[0m20:17:14.846979 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 6.18 seconds (6.18s).
[0m20:17:14.849325 [debug] [MainThread]: Command end result
[0m20:17:14.864452 [info ] [MainThread]: 
[0m20:17:14.865493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:17:14.866192 [info ] [MainThread]: 
[0m20:17:14.866965 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:17:14.867949 [debug] [MainThread]: Command `dbt run` succeeded at 20:17:14.867802 after 7.53 seconds
[0m20:17:14.868634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bee65cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50b7edf280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50b7de2050>]}
[0m20:17:14.869330 [debug] [MainThread]: Flushing usage events
[0m20:42:36.651128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba49155cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4755e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4755e3e0>]}


============================== 20:42:36.655663 | 9d293dad-103e-4695-836e-250a42e9937d ==============================
[0m20:42:36.655663 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:42:36.656326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'debug': 'False', 'profiles_dir': '/home/kj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:42:36.888323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d293dad-103e-4695-836e-250a42e9937d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4755e590>]}
[0m20:42:36.906990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d293dad-103e-4695-836e-250a42e9937d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba43a5b280>]}
[0m20:42:36.907819 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:42:36.917240 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:42:36.943808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:42:36.944512 [debug] [MainThread]: Partial parsing: added file: dbt_test_snow://models/example/snowflake_customer_purchases.sql
[0m20:42:36.945094 [debug] [MainThread]: Partial parsing: updated file: dbt_test_snow://models/example/schema.yml
[0m20:42:37.037134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d293dad-103e-4695-836e-250a42e9937d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4214bb50>]}
[0m20:42:37.047665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d293dad-103e-4695-836e-250a42e9937d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4206b0a0>]}
[0m20:42:37.048384 [info ] [MainThread]: Found 3 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:42:37.048859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d293dad-103e-4695-836e-250a42e9937d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4206b190>]}
[0m20:42:37.050473 [info ] [MainThread]: 
[0m20:42:37.051317 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:42:37.052715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:42:37.067907 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:42:37.068563 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:42:37.069043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:38.051576 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:42:38.053762 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:42:38.335812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m20:42:38.394469 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m20:42:38.395236 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m20:42:38.395738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:39.202797 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:42:39.204612 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m20:42:39.552061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d293dad-103e-4695-836e-250a42e9937d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4207d750>]}
[0m20:42:39.553564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:42:39.554538 [info ] [MainThread]: 
[0m20:42:39.559708 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m20:42:39.560824 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m20:42:39.562515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.my_first_dbt_model)
[0m20:42:39.563524 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m20:42:39.576899 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:42:39.578728 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 20:42:39.564175 => 20:42:39.577951
[0m20:42:39.579458 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m20:42:39.615959 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:42:39.617391 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m20:42:39.617956 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:42:39.618623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:40.992662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:42:41.015320 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 20:42:39.579938 => 20:42:41.015093
[0m20:42:41.015926 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m20:42:41.241409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d293dad-103e-4695-836e-250a42e9937d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba402d3cd0>]}
[0m20:42:41.242548 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.68s]
[0m20:42:41.243354 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m20:42:41.244002 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:42:41.245018 [info ] [Thread-1 (]: 2 of 3 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m20:42:41.245904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m20:42:41.246509 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m20:42:41.249496 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:42:41.250470 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 20:42:41.246879 => 20:42:41.250115
[0m20:42:41.251058 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m20:42:41.255567 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:42:41.256766 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:42:41.257338 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m20:42:41.257887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:43.016968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:42:43.021598 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 20:42:41.251475 => 20:42:43.021361
[0m20:42:43.022202 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m20:42:43.244891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d293dad-103e-4695-836e-250a42e9937d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4031ae90>]}
[0m20:42:43.246737 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 2.00s]
[0m20:42:43.248468 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:42:43.249696 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m20:42:43.251115 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt.my_second_dbt_model ............................ [RUN]
[0m20:42:43.253184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.snowflake_customer_purchases, now model.dbt_test_snow.my_second_dbt_model)
[0m20:42:43.254041 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_second_dbt_model
[0m20:42:43.259364 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_second_dbt_model"
[0m20:42:43.260976 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (compile): 20:42:43.254920 => 20:42:43.260425
[0m20:42:43.261781 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_second_dbt_model
[0m20:42:43.286874 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_second_dbt_model"
[0m20:42:43.288405 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_second_dbt_model"
[0m20:42:43.289075 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_second_dbt_model"} */
create or replace   view ANALYTICS.dbt.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from ANALYTICS.dbt.my_first_dbt_model
where id = 1
  );
[0m20:42:43.289680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:43.968115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:42:43.971814 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (execute): 20:42:43.262579 => 20:42:43.971595
[0m20:42:43.972460 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: Close
[0m20:42:44.146858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d293dad-103e-4695-836e-250a42e9937d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4031a020>]}
[0m20:42:44.147673 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.89s]
[0m20:42:44.148453 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m20:42:44.150488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:44.151039 [debug] [MainThread]: Connection 'model.dbt_test_snow.my_second_dbt_model' was properly closed.
[0m20:42:44.151506 [info ] [MainThread]: 
[0m20:42:44.152039 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 7.10 seconds (7.10s).
[0m20:42:44.153184 [debug] [MainThread]: Command end result
[0m20:42:44.162271 [info ] [MainThread]: 
[0m20:42:44.163041 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:42:44.163560 [info ] [MainThread]: 
[0m20:42:44.164125 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:42:44.164978 [debug] [MainThread]: Command `dbt run` succeeded at 20:42:44.164843 after 7.52 seconds
[0m20:42:44.165481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba49155cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba43a5b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4031b250>]}
[0m20:42:44.166014 [debug] [MainThread]: Flushing usage events
[0m19:23:49.575842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6128e59cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612728e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612728e3e0>]}


============================== 19:23:49.613443 | e838b2a7-ad1f-48d1-9b54-930f3c2080ac ==============================
[0m19:23:49.613443 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:23:49.614430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'profiles_dir': '/home/kj/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:53.221474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e838b2a7-ad1f-48d1-9b54-930f3c2080ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612728e590>]}
[0m19:23:53.239050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e838b2a7-ad1f-48d1-9b54-930f3c2080ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6121d07280>]}
[0m19:23:53.241048 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m19:23:53.260933 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:23:53.417525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:23:53.418297 [debug] [MainThread]: Partial parsing: added file: dbt_test_snow://models/example/cumulative_orders_by_date.sql
[0m19:23:53.467761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e838b2a7-ad1f-48d1-9b54-930f3c2080ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6121cf3b80>]}
[0m19:23:53.506895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e838b2a7-ad1f-48d1-9b54-930f3c2080ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6121caba90>]}
[0m19:23:53.507581 [info ] [MainThread]: Found 4 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m19:23:53.508168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e838b2a7-ad1f-48d1-9b54-930f3c2080ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6121cabcd0>]}
[0m19:23:53.509953 [info ] [MainThread]: 
[0m19:23:53.510965 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:53.512476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:23:53.526323 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:23:53.527004 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:23:53.527495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:56.141798 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 3.0 seconds
[0m19:23:56.144928 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:23:56.377584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m19:23:56.397471 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m19:23:56.398448 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m19:23:56.399276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:57.179351 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m19:23:57.185794 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m19:23:57.529627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e838b2a7-ad1f-48d1-9b54-930f3c2080ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6121cce3b0>]}
[0m19:23:57.533962 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:23:57.534804 [info ] [MainThread]: 
[0m19:23:57.799010 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:23:57.799753 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt.cumulative_orders_by_date ...................... [RUN]
[0m19:23:57.800756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m19:23:57.801310 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m19:23:57.865565 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:23:57.869423 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 19:23:57.801685 => 19:23:57.869086
[0m19:23:57.870073 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m19:23:57.901324 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:23:57.903204 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:23:57.903775 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace   view ANALYTICS.dbt.cumulative_orders_by_date
  
   as (
    SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
  );
[0m19:23:57.904479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:58.695687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:23:58.715562 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 19:23:57.870563 => 19:23:58.715356
[0m19:23:58.716287 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m19:23:58.940270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e838b2a7-ad1f-48d1-9b54-930f3c2080ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6103c6b130>]}
[0m19:23:58.941308 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt.cumulative_orders_by_date ................. [[32mSUCCESS 1[0m in 1.14s]
[0m19:23:58.942224 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:23:58.942854 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m19:23:58.943826 [info ] [Thread-1 (]: 2 of 4 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m19:23:58.944832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.my_first_dbt_model)
[0m19:23:58.945418 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m19:23:58.948394 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m19:23:59.942785 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 19:23:58.945850 => 19:23:59.941566
[0m19:23:59.946179 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m19:23:59.981675 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m19:23:59.982991 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m19:23:59.983528 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:23:59.983998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:01.563307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:24:01.570062 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 19:23:59.947450 => 19:24:01.569857
[0m19:24:01.570611 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m19:24:01.777461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e838b2a7-ad1f-48d1-9b54-930f3c2080ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6103cafeb0>]}
[0m19:24:01.781115 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbt.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 2.83s]
[0m19:24:01.782594 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m19:24:01.783724 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:24:01.785013 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m19:24:01.786593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m19:24:01.787578 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m19:24:01.793869 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:24:01.984407 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 19:24:01.788319 => 19:24:01.982800
[0m19:24:01.987383 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m19:24:01.996775 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:24:01.999568 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:24:02.000567 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m19:24:02.001763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:04.538000 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:24:04.542826 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 19:24:01.988828 => 19:24:04.542516
[0m19:24:04.543614 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m19:24:04.728548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e838b2a7-ad1f-48d1-9b54-930f3c2080ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6103c5eb30>]}
[0m19:24:04.732266 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 2.94s]
[0m19:24:04.736178 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:24:04.738814 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m19:24:04.741119 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt.my_second_dbt_model ............................ [RUN]
[0m19:24:04.743422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.snowflake_customer_purchases, now model.dbt_test_snow.my_second_dbt_model)
[0m19:24:04.745063 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_second_dbt_model
[0m19:24:04.751257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_second_dbt_model"
[0m19:24:04.753197 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (compile): 19:24:04.746027 => 19:24:04.752472
[0m19:24:04.754006 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_second_dbt_model
[0m19:24:04.759712 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_second_dbt_model"
[0m19:24:04.761378 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_second_dbt_model"
[0m19:24:04.762167 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_second_dbt_model"} */
create or replace   view ANALYTICS.dbt.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from ANALYTICS.dbt.my_first_dbt_model
where id = 1
  );
[0m19:24:04.762821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:05.459091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:24:05.467244 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (execute): 19:24:04.754584 => 19:24:05.466759
[0m19:24:05.468747 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: Close
[0m19:24:05.837199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e838b2a7-ad1f-48d1-9b54-930f3c2080ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6103c5d480>]}
[0m19:24:05.838025 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 1.09s]
[0m19:24:05.838847 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m19:24:05.841275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:05.841729 [debug] [MainThread]: Connection 'model.dbt_test_snow.my_second_dbt_model' was properly closed.
[0m19:24:05.842221 [info ] [MainThread]: 
[0m19:24:05.842775 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 12.33 seconds (12.33s).
[0m19:24:05.844318 [debug] [MainThread]: Command end result
[0m19:24:05.853147 [info ] [MainThread]: 
[0m19:24:05.853907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:05.854441 [info ] [MainThread]: 
[0m19:24:05.855477 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:24:05.856665 [debug] [MainThread]: Command `dbt run` succeeded at 19:24:05.856526 after 16.34 seconds
[0m19:24:05.857180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6128e59cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6121d07280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6103c1fb20>]}
[0m19:24:05.857691 [debug] [MainThread]: Flushing usage events
[0m19:36:40.699125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2fe43d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2fc8724d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2fc872470>]}


============================== 19:36:40.703640 | af06e374-51b9-45c2-b208-7bc4dd647542 ==============================
[0m19:36:40.703640 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:36:40.704581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'version_check': 'True', 'profiles_dir': '/home/kj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:36:40.922923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af06e374-51b9-45c2-b208-7bc4dd647542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2fc872620>]}
[0m19:36:40.940972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af06e374-51b9-45c2-b208-7bc4dd647542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f74eb3d0>]}
[0m19:36:40.941887 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m19:36:40.950478 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:36:40.976406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:36:40.977182 [debug] [MainThread]: Partial parsing: added file: dbt_test_snow://models/example/dates.sql
[0m19:36:40.977819 [debug] [MainThread]: Partial parsing: updated file: dbt_test_snow://models/example/schema.yml
[0m19:36:41.049107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af06e374-51b9-45c2-b208-7bc4dd647542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f719c670>]}
[0m19:36:41.060488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af06e374-51b9-45c2-b208-7bc4dd647542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f729bd30>]}
[0m19:36:41.061252 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m19:36:41.061810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af06e374-51b9-45c2-b208-7bc4dd647542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f729bca0>]}
[0m19:36:41.063446 [info ] [MainThread]: 
[0m19:36:41.064427 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:36:41.066084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:36:41.080107 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:36:41.080738 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:36:41.081266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:42.327175 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m19:36:42.329091 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:36:42.652907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m19:36:42.664345 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m19:36:42.664995 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m19:36:42.665441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:43.566620 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:36:43.576655 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m19:36:43.778032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af06e374-51b9-45c2-b208-7bc4dd647542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f7166b30>]}
[0m19:36:43.778924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:43.779454 [info ] [MainThread]: 
[0m19:36:43.782544 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:36:43.783238 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt.cumulative_orders_by_date ...................... [RUN]
[0m19:36:43.784039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m19:36:43.784665 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m19:36:43.791656 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:36:43.792728 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 19:36:43.785025 => 19:36:43.792497
[0m19:36:43.793373 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m19:36:43.825431 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:36:43.827333 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:36:43.828059 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace   view ANALYTICS.dbt.cumulative_orders_by_date
  
   as (
    SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
  );
[0m19:36:43.828720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:45.278363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:36:45.321833 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 19:36:43.793747 => 19:36:45.321585
[0m19:36:45.322412 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m19:36:45.640928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af06e374-51b9-45c2-b208-7bc4dd647542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f65b9d50>]}
[0m19:36:45.642172 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt.cumulative_orders_by_date ................. [[32mSUCCESS 1[0m in 1.86s]
[0m19:36:45.643482 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:36:45.645447 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m19:36:45.646418 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m19:36:45.647751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m19:36:45.648964 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m19:36:45.654674 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m19:36:45.655554 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 19:36:45.649653 => 19:36:45.655320
[0m19:36:45.656063 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m19:36:45.709389 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m19:36:45.711409 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:36:45.712083 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace transient table ANALYTICS.dbt.dates
         as
        (

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


        );
[0m19:36:45.712766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:47.886238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:36:47.900629 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:36:47.901255 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m19:36:48.074059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:36:48.077148 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 19:36:45.656529 => 19:36:48.076948
[0m19:36:48.077724 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m19:36:48.281685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af06e374-51b9-45c2-b208-7bc4dd647542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f66f8730>]}
[0m19:36:48.282640 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 1[0m in 2.63s]
[0m19:36:48.283570 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m19:36:48.284380 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m19:36:48.285130 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m19:36:48.286061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m19:36:48.286807 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m19:36:48.289973 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m19:36:48.291495 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 19:36:48.287316 => 19:36:48.291011
[0m19:36:48.292122 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m19:36:48.303358 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m19:36:48.305311 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m19:36:48.305965 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:36:48.306589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:49.600103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:36:49.603812 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 19:36:48.292653 => 19:36:49.603568
[0m19:36:49.604622 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m19:36:49.876979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af06e374-51b9-45c2-b208-7bc4dd647542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f668ba00>]}
[0m19:36:49.879314 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.59s]
[0m19:36:49.881943 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m19:36:49.883790 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:36:49.885904 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m19:36:49.889597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m19:36:49.891643 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m19:36:49.898125 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:36:49.899697 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 19:36:49.893163 => 19:36:49.899208
[0m19:36:49.900665 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m19:36:49.905504 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:36:49.907336 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:36:49.908361 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m19:36:49.908937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:51.739616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:36:51.742962 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 19:36:49.901283 => 19:36:51.742725
[0m19:36:51.743490 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m19:36:51.935464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af06e374-51b9-45c2-b208-7bc4dd647542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f658f3d0>]}
[0m19:36:51.938607 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 2.05s]
[0m19:36:51.942127 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:36:51.944980 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m19:36:51.947582 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt.my_second_dbt_model ............................ [RUN]
[0m19:36:51.950505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.snowflake_customer_purchases, now model.dbt_test_snow.my_second_dbt_model)
[0m19:36:51.952380 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_second_dbt_model
[0m19:36:51.958528 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_second_dbt_model"
[0m19:36:51.960557 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (compile): 19:36:51.953334 => 19:36:51.959838
[0m19:36:51.961463 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_second_dbt_model
[0m19:36:51.966843 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_second_dbt_model"
[0m19:36:51.968737 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_second_dbt_model"
[0m19:36:51.969505 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_second_dbt_model"} */
create or replace   view ANALYTICS.dbt.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from ANALYTICS.dbt.my_first_dbt_model
where id = 1
  );
[0m19:36:51.970159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:52.681554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:36:52.685817 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (execute): 19:36:51.962046 => 19:36:52.685614
[0m19:36:52.686376 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: Close
[0m19:36:52.990454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af06e374-51b9-45c2-b208-7bc4dd647542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f668a800>]}
[0m19:36:52.991263 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 1.04s]
[0m19:36:52.992071 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m19:36:52.994475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:52.994900 [debug] [MainThread]: Connection 'model.dbt_test_snow.my_second_dbt_model' was properly closed.
[0m19:36:52.995356 [info ] [MainThread]: 
[0m19:36:52.996011 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 11.93 seconds (11.93s).
[0m19:36:52.997650 [debug] [MainThread]: Command end result
[0m19:36:53.006909 [info ] [MainThread]: 
[0m19:36:53.007692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:36:53.008329 [info ] [MainThread]: 
[0m19:36:53.009098 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:36:53.010045 [debug] [MainThread]: Command `dbt run` succeeded at 19:36:53.009926 after 12.32 seconds
[0m19:36:53.010531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2fe43d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f65843a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f66c8070>]}
[0m19:36:53.011029 [debug] [MainThread]: Flushing usage events
[0m19:47:15.661573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e2ee69cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e2d2a2440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e2d2a23e0>]}


============================== 19:47:15.666030 | 92bac2ca-d0b5-4020-9718-c552cad0ca8a ==============================
[0m19:47:15.666030 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:47:15.666660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kj/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:47:16.110611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92bac2ca-d0b5-4020-9718-c552cad0ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e2d2a2590>]}
[0m19:47:16.129276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92bac2ca-d0b5-4020-9718-c552cad0ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e27d1f280>]}
[0m19:47:16.130122 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m19:47:16.139013 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:47:16.164567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:47:16.165388 [debug] [MainThread]: Partial parsing: updated file: dbt_test_snow://models/example/my_first_dbt_model.sql
[0m19:47:16.257859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92bac2ca-d0b5-4020-9718-c552cad0ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e27b8feb0>]}
[0m19:47:16.268275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92bac2ca-d0b5-4020-9718-c552cad0ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e27c1b220>]}
[0m19:47:16.269041 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m19:47:16.269579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92bac2ca-d0b5-4020-9718-c552cad0ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e27c1b1c0>]}
[0m19:47:16.271164 [info ] [MainThread]: 
[0m19:47:16.272028 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:47:16.273668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:47:16.287809 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:47:16.288486 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:47:16.288931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:17.289483 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m19:47:17.295529 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:47:17.565357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m19:47:17.573757 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m19:47:17.574300 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m19:47:17.574722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:18.415127 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m19:47:18.417733 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m19:47:18.619152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92bac2ca-d0b5-4020-9718-c552cad0ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e27b287f0>]}
[0m19:47:18.620039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:47:18.620839 [info ] [MainThread]: 
[0m19:47:18.624131 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:47:18.624916 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt.cumulative_orders_by_date ...................... [RUN]
[0m19:47:18.625747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m19:47:18.626277 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m19:47:18.633464 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:47:18.634499 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 19:47:18.626682 => 19:47:18.634249
[0m19:47:18.635180 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m19:47:18.668825 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:47:18.670204 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:47:18.670812 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace   view ANALYTICS.dbt.cumulative_orders_by_date
  
   as (
    SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
  );
[0m19:47:18.671312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:19.855600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:47:19.880090 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 19:47:18.635565 => 19:47:19.879867
[0m19:47:19.880766 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m19:47:20.089259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92bac2ca-d0b5-4020-9718-c552cad0ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e27b6bd00>]}
[0m19:47:20.090085 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt.cumulative_orders_by_date ................. [[32mSUCCESS 1[0m in 1.46s]
[0m19:47:20.090877 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:47:20.091436 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m19:47:20.092041 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m19:47:20.093040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m19:47:20.093793 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m19:47:20.103854 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m19:47:20.105123 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 19:47:20.094222 => 19:47:20.104633
[0m19:47:20.105770 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m19:47:20.144961 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:47:20.146116 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m19:47:20.147116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:20.838018 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:47:20.849396 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:47:20.850030 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m19:47:21.034011 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:47:21.039435 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:47:21.040110 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m19:47:21.431103 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:47:21.440783 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:47:21.441441 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m19:47:21.626350 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:47:21.660515 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m19:47:21.663108 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:47:21.663690 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m19:47:21.867010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:47:21.869719 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:47:21.871976 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m19:47:22.959837 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m19:47:22.960601 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:47:22.961112 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m19:47:23.171242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:47:23.186054 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:47:23.186682 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m19:47:23.378600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:47:23.391881 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 19:47:20.106227 => 19:47:23.391227
[0m19:47:23.394008 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m19:47:23.725065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92bac2ca-d0b5-4020-9718-c552cad0ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e25fa4fd0>]}
[0m19:47:23.726326 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 3.63s]
[0m19:47:23.727415 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m19:47:23.727996 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m19:47:23.728698 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m19:47:23.729534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m19:47:23.730047 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m19:47:23.733509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m19:47:23.734864 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 19:47:23.730448 => 19:47:23.734524
[0m19:47:23.735426 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m19:47:23.757880 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m19:47:23.759238 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m19:47:23.759753 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.first_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:47:23.760260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:25.090260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:47:25.093794 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 19:47:23.735791 => 19:47:25.093541
[0m19:47:25.094446 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m19:47:25.422260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92bac2ca-d0b5-4020-9718-c552cad0ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e27c194e0>]}
[0m19:47:25.424875 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt.first_model .............................. [[32mSUCCESS 1[0m in 1.69s]
[0m19:47:25.427543 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m19:47:25.429682 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:47:25.431644 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m19:47:25.434082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m19:47:25.434737 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m19:47:25.438275 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:47:25.439427 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 19:47:25.435202 => 19:47:25.439044
[0m19:47:25.439951 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m19:47:25.443260 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:47:25.444706 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:47:25.445273 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m19:47:25.445761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:27.217654 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:47:27.223133 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 19:47:25.440482 => 19:47:27.222800
[0m19:47:27.224067 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m19:47:27.514274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92bac2ca-d0b5-4020-9718-c552cad0ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e27c197b0>]}
[0m19:47:27.515135 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 2.08s]
[0m19:47:27.516107 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:47:27.516761 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m19:47:27.517564 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt.my_second_dbt_model ............................ [RUN]
[0m19:47:27.518470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.snowflake_customer_purchases, now model.dbt_test_snow.my_second_dbt_model)
[0m19:47:27.519021 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_second_dbt_model
[0m19:47:27.523511 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_second_dbt_model"
[0m19:47:27.525015 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (compile): 19:47:27.519418 => 19:47:27.524653
[0m19:47:27.525580 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_second_dbt_model
[0m19:47:27.529401 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_second_dbt_model"
[0m19:47:27.530852 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_second_dbt_model"
[0m19:47:27.531470 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_second_dbt_model"} */
create or replace   view ANALYTICS.dbt.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from ANALYTICS.dbt.first_model
where id = 1
  );
[0m19:47:27.532145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:28.488618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:47:28.493726 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (execute): 19:47:27.526027 => 19:47:28.493511
[0m19:47:28.494350 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: Close
[0m19:47:28.810774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92bac2ca-d0b5-4020-9718-c552cad0ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e2466f6d0>]}
[0m19:47:28.811718 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 1.29s]
[0m19:47:28.812632 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m19:47:28.815140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:28.815637 [debug] [MainThread]: Connection 'model.dbt_test_snow.my_second_dbt_model' was properly closed.
[0m19:47:28.816386 [info ] [MainThread]: 
[0m19:47:28.817098 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 12.54 seconds (12.54s).
[0m19:47:28.818651 [debug] [MainThread]: Command end result
[0m19:47:28.827254 [info ] [MainThread]: 
[0m19:47:28.827983 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:47:28.828458 [info ] [MainThread]: 
[0m19:47:28.829075 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:47:28.829872 [debug] [MainThread]: Command `dbt run` succeeded at 19:47:28.829726 after 13.18 seconds
[0m19:47:28.830357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e2ee69cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e27d1f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e2469b130>]}
[0m19:47:28.830865 [debug] [MainThread]: Flushing usage events
[0m19:50:49.554976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c5f55420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c43924d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4392fe0>]}


============================== 19:50:49.559487 | 494afa3f-09a2-49c9-ad4b-dce8329e806e ==============================
[0m19:50:49.559487 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:50:49.560143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kj/.dbt', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:50:50.028962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '494afa3f-09a2-49c9-ad4b-dce8329e806e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4392620>]}
[0m19:50:50.047265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '494afa3f-09a2-49c9-ad4b-dce8329e806e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c088f3d0>]}
[0m19:50:50.048092 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m19:50:50.057067 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:50:50.065498 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:50:50.066151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '494afa3f-09a2-49c9-ad4b-dce8329e806e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c088d000>]}
[0m19:50:50.987593 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_test_snow.example.vars
[0m19:50:50.992786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '494afa3f-09a2-49c9-ad4b-dce8329e806e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bddbc0d0>]}
[0m19:50:51.004351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '494afa3f-09a2-49c9-ad4b-dce8329e806e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c088fc10>]}
[0m19:50:51.005045 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m19:50:51.005597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '494afa3f-09a2-49c9-ad4b-dce8329e806e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c0871540>]}
[0m19:50:51.007261 [info ] [MainThread]: 
[0m19:50:51.008264 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:50:51.009948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:50:51.025011 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:50:51.025673 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:50:51.026150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:52.012426 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m19:50:52.019738 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:50:52.268006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m19:50:52.283865 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m19:50:52.284684 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m19:50:52.285284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:52.993896 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m19:50:52.999262 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m19:50:53.326656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '494afa3f-09a2-49c9-ad4b-dce8329e806e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bddeb7f0>]}
[0m19:50:53.327640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:50:53.328275 [info ] [MainThread]: 
[0m19:50:53.331449 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:50:53.332177 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt.cumulative_orders_by_date ...................... [RUN]
[0m19:50:53.333030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m19:50:53.333518 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m19:50:53.341458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:50:53.342515 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 19:50:53.333901 => 19:50:53.342255
[0m19:50:53.343161 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m19:50:53.380250 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:50:53.382016 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:50:53.382713 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace   view ANALYTICS.dbt.cumulative_orders_by_date
  
   as (
    SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
  );
[0m19:50:53.383302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:54.289666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:50:54.312210 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 19:50:53.343545 => 19:50:54.311993
[0m19:50:54.312973 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m19:50:54.646950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494afa3f-09a2-49c9-ad4b-dce8329e806e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bd00aa70>]}
[0m19:50:54.651195 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt.cumulative_orders_by_date ................. [[32mSUCCESS 1[0m in 1.31s]
[0m19:50:54.655223 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:50:54.658008 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m19:50:54.660519 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m19:50:54.665331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m19:50:54.667558 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m19:50:54.680874 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m19:50:54.682770 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 19:50:54.668998 => 19:50:54.682179
[0m19:50:54.683610 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m19:50:54.726999 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:50:54.727625 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m19:50:54.728144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:55.571276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:50:55.581334 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:50:55.581923 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m19:50:55.746517 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:50:55.751880 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:50:55.752546 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m19:50:55.917256 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:50:55.937954 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:50:55.938812 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m19:50:56.092824 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:50:56.144085 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m19:50:56.146594 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:50:56.147183 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m19:50:56.319766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:50:56.320624 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:50:56.321312 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m19:50:57.236130 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m19:50:57.237670 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:50:57.238709 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m19:50:57.433376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:50:57.449712 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:50:57.450361 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m19:50:57.619031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:50:57.622206 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 19:50:54.684255 => 19:50:57.621993
[0m19:50:57.622769 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m19:50:57.874746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494afa3f-09a2-49c9-ad4b-dce8329e806e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bd031cc0>]}
[0m19:50:57.878351 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 3.21s]
[0m19:50:57.882317 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m19:50:57.884336 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m19:50:57.886676 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m19:50:57.889031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m19:50:57.890817 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m19:50:57.935924 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 19:50:57.891759 => 19:50:57.935615
[0m19:50:58.159661 [debug] [Thread-1 (]: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
[0m19:50:58.162399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494afa3f-09a2-49c9-ad4b-dce8329e806e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bcfb1f00>]}
[0m19:50:58.165170 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model dbt.first_model .......................... [[31mERROR[0m in 0.27s]
[0m19:50:58.167908 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m19:50:58.170563 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:50:58.174055 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m19:50:58.176604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m19:50:58.178939 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m19:50:58.185210 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:50:58.186947 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 19:50:58.179713 => 19:50:58.186361
[0m19:50:58.187752 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m19:50:58.215741 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:50:58.217763 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:50:58.218346 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m19:50:58.218866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:00.063316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:51:00.067515 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 19:50:58.188307 => 19:51:00.067291
[0m19:51:00.068183 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m19:51:00.290423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494afa3f-09a2-49c9-ad4b-dce8329e806e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bd026740>]}
[0m19:51:00.293425 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 2.11s]
[0m19:51:00.296681 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:51:00.298354 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m19:51:00.299948 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m19:51:00.302113 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m19:51:00.306513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:00.307325 [debug] [MainThread]: Connection 'model.dbt_test_snow.snowflake_customer_purchases' was properly closed.
[0m19:51:00.308132 [info ] [MainThread]: 
[0m19:51:00.309109 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 9.30 seconds (9.30s).
[0m19:51:00.310942 [debug] [MainThread]: Command end result
[0m19:51:00.320023 [info ] [MainThread]: 
[0m19:51:00.320777 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:51:00.321297 [info ] [MainThread]: 
[0m19:51:00.321832 [error] [MainThread]:   Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
[0m19:51:00.322369 [info ] [MainThread]: 
[0m19:51:00.322955 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m19:51:00.323808 [debug] [MainThread]: Command `dbt run` failed at 19:51:00.323661 after 10.78 seconds
[0m19:51:00.325099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c5f55420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bef53010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bd058a30>]}
[0m19:51:00.325860 [debug] [MainThread]: Flushing usage events
[0m19:51:36.998752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7f71db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe64b2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe64b2410>]}


============================== 19:51:37.003175 | 7b20f3a0-6f5a-419c-bbab-51f96093a7de ==============================
[0m19:51:37.003175 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:51:37.003827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kj/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:51:37.229812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b20f3a0-6f5a-419c-bbab-51f96093a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe64b25c0>]}
[0m19:51:37.248229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b20f3a0-6f5a-419c-bbab-51f96093a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe0f1b3d0>]}
[0m19:51:37.249169 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m19:51:37.258180 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:51:37.284119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:37.284642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:37.285630 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_test_snow.example.vars
[0m19:51:37.291488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b20f3a0-6f5a-419c-bbab-51f96093a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe0d040d0>]}
[0m19:51:37.304407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b20f3a0-6f5a-419c-bbab-51f96093a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe0e131c0>]}
[0m19:51:37.305090 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m19:51:37.305626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b20f3a0-6f5a-419c-bbab-51f96093a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe0e131f0>]}
[0m19:51:37.307403 [info ] [MainThread]: 
[0m19:51:37.308377 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:51:37.309971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:51:37.327879 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:51:37.328427 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:51:37.328975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:38.367329 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m19:51:38.373501 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:51:38.718186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m19:51:38.729158 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m19:51:38.729663 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m19:51:38.730082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:39.383668 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m19:51:39.391672 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m19:51:39.643017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b20f3a0-6f5a-419c-bbab-51f96093a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe57d7040>]}
[0m19:51:39.645396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:39.646651 [info ] [MainThread]: 
[0m19:51:39.653120 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:51:39.654404 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt.cumulative_orders_by_date ...................... [RUN]
[0m19:51:39.655787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m19:51:39.656826 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m19:51:39.667475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:51:39.668791 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 19:51:39.657475 => 19:51:39.668334
[0m19:51:39.669421 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m19:51:39.702766 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:51:39.704965 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:51:39.705764 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace   view ANALYTICS.dbt.cumulative_orders_by_date
  
   as (
    SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
  );
[0m19:51:39.706596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:40.426378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:51:40.450484 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 19:51:39.669841 => 19:51:40.450262
[0m19:51:40.451070 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m19:51:40.759257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b20f3a0-6f5a-419c-bbab-51f96093a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe00d2770>]}
[0m19:51:40.760287 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt.cumulative_orders_by_date ................. [[32mSUCCESS 1[0m in 1.10s]
[0m19:51:40.761148 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:51:40.761785 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m19:51:40.762428 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m19:51:40.763292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m19:51:40.763812 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m19:51:40.773659 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m19:51:40.774877 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 19:51:40.764217 => 19:51:40.774435
[0m19:51:40.775469 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m19:51:40.816839 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:51:40.817780 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m19:51:40.818743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:41.665863 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:51:41.716580 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:51:41.717334 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m19:51:41.873017 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:51:41.877920 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:51:41.878443 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m19:51:41.963486 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:51:41.989778 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:51:41.990659 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m19:51:42.132121 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:51:42.169011 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m19:51:42.171408 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:51:42.171935 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m19:51:42.342779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:51:42.345464 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:51:42.348405 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m19:51:43.177946 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m19:51:43.178916 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:51:43.179675 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m19:51:43.358882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:51:43.370882 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:51:43.371446 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m19:51:43.528117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:51:43.536076 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 19:51:40.775840 => 19:51:43.535469
[0m19:51:43.537642 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m19:51:43.806144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b20f3a0-6f5a-419c-bbab-51f96093a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe0148f70>]}
[0m19:51:43.807790 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 3.04s]
[0m19:51:43.809697 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m19:51:43.810943 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m19:51:43.812196 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m19:51:43.814550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m19:51:43.815766 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m19:51:43.821622 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 19:51:43.816545 => 19:51:43.821311
[0m19:51:43.823571 [debug] [Thread-1 (]: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
[0m19:51:43.824212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b20f3a0-6f5a-419c-bbab-51f96093a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe014bd60>]}
[0m19:51:43.825066 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model dbt.first_model .......................... [[31mERROR[0m in 0.01s]
[0m19:51:43.825842 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m19:51:43.826447 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:51:43.827122 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m19:51:43.828413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m19:51:43.829103 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m19:51:43.832254 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:51:43.835845 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 19:51:43.829511 => 19:51:43.835340
[0m19:51:43.836456 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m19:51:43.866925 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:51:43.868837 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:51:43.869452 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m19:51:43.869981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:45.309949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:51:45.313536 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 19:51:43.836987 => 19:51:45.313259
[0m19:51:45.314149 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m19:51:45.574266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b20f3a0-6f5a-419c-bbab-51f96093a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfda73bd30>]}
[0m19:51:45.577979 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 1.75s]
[0m19:51:45.581900 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:51:45.583951 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m19:51:45.586196 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m19:51:45.588091 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m19:51:45.593194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:45.594303 [debug] [MainThread]: Connection 'model.dbt_test_snow.snowflake_customer_purchases' was properly closed.
[0m19:51:45.595372 [info ] [MainThread]: 
[0m19:51:45.596430 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 8.29 seconds (8.29s).
[0m19:51:45.598540 [debug] [MainThread]: Command end result
[0m19:51:45.610664 [info ] [MainThread]: 
[0m19:51:45.611610 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:51:45.612287 [info ] [MainThread]: 
[0m19:51:45.612927 [error] [MainThread]:   Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
[0m19:51:45.613500 [info ] [MainThread]: 
[0m19:51:45.614072 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m19:51:45.615013 [debug] [MainThread]: Command `dbt run` failed at 19:51:45.614844 after 8.63 seconds
[0m19:51:45.615560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7f71db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfda73bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfda73beb0>]}
[0m19:51:45.616161 [debug] [MainThread]: Flushing usage events
[0m19:53:11.053323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca7371db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca57aa470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca57aa410>]}


============================== 19:53:11.057953 | ffc203f1-1b3e-46b8-8be2-108e525cc8a8 ==============================
[0m19:53:11.057953 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:53:11.058596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kj/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:53:11.311609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffc203f1-1b3e-46b8-8be2-108e525cc8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca57aa5c0>]}
[0m19:53:11.330063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffc203f1-1b3e-46b8-8be2-108e525cc8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca021b3d0>]}
[0m19:53:11.330928 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m19:53:11.339860 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:53:11.366598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:53:11.367206 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:53:11.368104 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_test_snow.example.vars
[0m19:53:11.373965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffc203f1-1b3e-46b8-8be2-108e525cc8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9bf040d0>]}
[0m19:53:11.385912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffc203f1-1b3e-46b8-8be2-108e525cc8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca01cf1c0>]}
[0m19:53:11.386692 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m19:53:11.387205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc203f1-1b3e-46b8-8be2-108e525cc8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca01cf1f0>]}
[0m19:53:11.389175 [info ] [MainThread]: 
[0m19:53:11.390187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:53:11.391740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:53:11.407778 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:53:11.408552 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:53:11.409272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:12.494254 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m19:53:12.499561 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:53:12.847301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m19:53:12.865902 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m19:53:12.866742 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m19:53:12.867427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:13.674189 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m19:53:13.676711 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m19:53:14.077319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc203f1-1b3e-46b8-8be2-108e525cc8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9bf4dd80>]}
[0m19:53:14.078358 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:53:14.078983 [info ] [MainThread]: 
[0m19:53:14.082480 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:53:14.083143 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt.cumulative_orders_by_date ...................... [RUN]
[0m19:53:14.084179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m19:53:14.084901 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m19:53:14.093901 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:53:14.095025 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 19:53:14.085465 => 19:53:14.094635
[0m19:53:14.095543 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m19:53:14.133344 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:53:14.134689 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:53:14.135239 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace   view ANALYTICS.dbt.cumulative_orders_by_date
  
   as (
    SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
  );
[0m19:53:14.135781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:14.907207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:53:14.947575 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 19:53:14.095897 => 19:53:14.947348
[0m19:53:14.948185 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m19:53:15.157659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc203f1-1b3e-46b8-8be2-108e525cc8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9b356770>]}
[0m19:53:15.159539 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt.cumulative_orders_by_date ................. [[32mSUCCESS 1[0m in 1.07s]
[0m19:53:15.161734 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:53:15.163176 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m19:53:15.164653 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m19:53:15.166983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m19:53:15.168900 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m19:53:15.184419 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m19:53:15.185933 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 19:53:15.169937 => 19:53:15.185509
[0m19:53:15.186582 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m19:53:15.225024 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:53:15.225637 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m19:53:15.226150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:15.925314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:53:15.992099 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:53:15.992847 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m19:53:16.161659 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:53:16.167944 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:53:16.168443 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m19:53:16.344649 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:53:16.367499 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:53:16.368394 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m19:53:16.531714 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:53:16.564693 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m19:53:16.566957 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:53:16.567478 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m19:53:16.753628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:53:16.755858 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:53:16.758531 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m19:53:17.987735 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m19:53:17.988554 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:53:17.989062 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m19:53:18.210443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:53:18.223677 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:53:18.224275 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m19:53:18.416888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:53:18.419812 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 19:53:15.187109 => 19:53:18.419575
[0m19:53:18.420343 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m19:53:18.621703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc203f1-1b3e-46b8-8be2-108e525cc8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9b3cf940>]}
[0m19:53:18.622672 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 3.46s]
[0m19:53:18.623537 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m19:53:18.624168 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m19:53:18.624912 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m19:53:18.625795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m19:53:18.626349 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m19:53:18.630573 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 19:53:18.626748 => 19:53:18.630270
[0m19:53:18.632913 [debug] [Thread-1 (]: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
[0m19:53:18.633510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc203f1-1b3e-46b8-8be2-108e525cc8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9b3cd000>]}
[0m19:53:18.634208 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model dbt.first_model .......................... [[31mERROR[0m in 0.01s]
[0m19:53:18.634968 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m19:53:18.635622 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:53:18.636516 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m19:53:18.637840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m19:53:18.638490 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m19:53:18.641716 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:53:18.643270 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 19:53:18.638947 => 19:53:18.642863
[0m19:53:18.643855 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m19:53:18.669480 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:53:18.671541 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:53:18.672141 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m19:53:18.672811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:20.665342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:53:20.669055 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 19:53:18.644222 => 19:53:20.668774
[0m19:53:20.669678 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m19:53:20.926799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc203f1-1b3e-46b8-8be2-108e525cc8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca57aa5f0>]}
[0m19:53:20.927642 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 2.29s]
[0m19:53:20.928439 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:53:20.929205 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m19:53:20.929825 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m19:53:20.930438 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m19:53:20.932394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:20.932977 [debug] [MainThread]: Connection 'model.dbt_test_snow.snowflake_customer_purchases' was properly closed.
[0m19:53:20.933451 [info ] [MainThread]: 
[0m19:53:20.933989 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 9.54 seconds (9.54s).
[0m19:53:20.935298 [debug] [MainThread]: Command end result
[0m19:53:20.944527 [info ] [MainThread]: 
[0m19:53:20.945181 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:53:20.945732 [info ] [MainThread]: 
[0m19:53:20.946221 [error] [MainThread]:   Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
[0m19:53:20.946773 [info ] [MainThread]: 
[0m19:53:20.947281 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m19:53:20.948126 [debug] [MainThread]: Command `dbt run` failed at 19:53:20.948014 after 9.90 seconds
[0m19:53:20.948845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca7371db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca01ef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca01ef9a0>]}
[0m19:53:20.949326 [debug] [MainThread]: Flushing usage events
[0m19:55:04.233577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806996ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8067eaa470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8067eaa410>]}


============================== 19:55:04.238130 | 2337c72a-33bd-4103-a231-eee6fb6dc10b ==============================
[0m19:55:04.238130 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:55:04.238776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kj/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:55:04.453425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2337c72a-33bd-4103-a231-eee6fb6dc10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8067eaa5c0>]}
[0m19:55:04.472212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2337c72a-33bd-4103-a231-eee6fb6dc10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80629133d0>]}
[0m19:55:04.473136 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m19:55:04.482234 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:55:04.490903 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:55:04.491537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2337c72a-33bd-4103-a231-eee6fb6dc10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8062910fa0>]}
[0m19:55:05.406896 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_test_snow.example.vars
[0m19:55:05.412595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2337c72a-33bd-4103-a231-eee6fb6dc10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80617d3fd0>]}
[0m19:55:05.424098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2337c72a-33bd-4103-a231-eee6fb6dc10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8062913bb0>]}
[0m19:55:05.424827 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m19:55:05.425422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2337c72a-33bd-4103-a231-eee6fb6dc10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80642858a0>]}
[0m19:55:05.427628 [info ] [MainThread]: 
[0m19:55:05.428979 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:55:05.433527 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:55:05.452276 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:55:05.454582 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:55:05.456156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:06.430933 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m19:55:06.438887 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:55:06.671253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m19:55:06.679903 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m19:55:06.680553 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m19:55:06.680995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:07.722486 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m19:55:07.724278 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m19:55:08.030531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2337c72a-33bd-4103-a231-eee6fb6dc10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80617e6a40>]}
[0m19:55:08.033604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:55:08.035344 [info ] [MainThread]: 
[0m19:55:08.044364 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:55:08.046164 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt.cumulative_orders_by_date ..................... [RUN]
[0m19:55:08.047747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m19:55:08.048712 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m19:55:08.064046 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:55:08.065574 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 19:55:08.049566 => 19:55:08.065124
[0m19:55:08.066373 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m19:55:08.086077 [debug] [Thread-1 (]: Dropping relation "ANALYTICS"."DBT"."CUMULATIVE_ORDERS_BY_DATE" because it is of type view
[0m19:55:08.102020 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:55:08.103904 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
drop view if exists "ANALYTICS"."DBT"."CUMULATIVE_ORDERS_BY_DATE" cascade
[0m19:55:08.104533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:08.742801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:55:08.773751 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:55:08.775426 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:55:08.776106 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace transient table ANALYTICS.dbt.cumulative_orders_by_date
         as
        (SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
        );
[0m19:55:10.816201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:55:10.861463 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 19:55:08.066855 => 19:55:10.861214
[0m19:55:10.862079 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m19:55:11.087820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2337c72a-33bd-4103-a231-eee6fb6dc10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8060b143d0>]}
[0m19:55:11.089229 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbt.cumulative_orders_by_date ................ [[32mSUCCESS 1[0m in 3.04s]
[0m19:55:11.090527 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:55:11.092067 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m19:55:11.093115 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m19:55:11.094456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m19:55:11.095294 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m19:55:11.103369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m19:55:11.104665 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 19:55:11.096165 => 19:55:11.104187
[0m19:55:11.105272 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m19:55:11.151412 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:55:11.152052 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m19:55:11.152543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:11.940592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:55:11.949274 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:55:11.949908 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m19:55:12.134001 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:55:12.138958 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:55:12.139536 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m19:55:12.321635 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:55:12.349261 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:55:12.350219 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m19:55:12.518573 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:55:12.567112 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m19:55:12.569733 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:55:12.570250 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m19:55:12.763623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:55:12.765254 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:55:12.766735 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m19:55:13.422777 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m19:55:13.425944 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:55:13.428208 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m19:55:13.669299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:55:13.673670 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:55:13.674226 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m19:55:13.861198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:55:13.865131 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 19:55:11.105701 => 19:55:13.864646
[0m19:55:13.865767 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m19:55:14.470155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2337c72a-33bd-4103-a231-eee6fb6dc10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8060b17c70>]}
[0m19:55:14.473337 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 3.38s]
[0m19:55:14.476691 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m19:55:14.478936 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m19:55:14.481295 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m19:55:14.484124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m19:55:14.485698 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m19:55:14.493665 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 19:55:14.486552 => 19:55:14.493210
[0m19:55:14.497056 [debug] [Thread-1 (]: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
[0m19:55:14.498091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2337c72a-33bd-4103-a231-eee6fb6dc10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8060b162c0>]}
[0m19:55:14.499276 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model dbt.first_model .......................... [[31mERROR[0m in 0.01s]
[0m19:55:14.500531 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m19:55:14.501331 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:55:14.502138 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m19:55:14.503252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m19:55:14.503945 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m19:55:14.509532 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:55:14.511481 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 19:55:14.504707 => 19:55:14.511021
[0m19:55:14.512196 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m19:55:14.516177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:55:14.517802 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:55:14.518470 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m19:55:14.518995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:16.393139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:55:16.396437 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 19:55:14.512570 => 19:55:16.396004
[0m19:55:16.397142 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m19:55:16.711915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2337c72a-33bd-4103-a231-eee6fb6dc10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80600cad70>]}
[0m19:55:16.712751 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 2.21s]
[0m19:55:16.713977 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:55:16.714830 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m19:55:16.715446 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m19:55:16.716151 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m19:55:16.718625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:16.719175 [debug] [MainThread]: Connection 'model.dbt_test_snow.snowflake_customer_purchases' was properly closed.
[0m19:55:16.719731 [info ] [MainThread]: 
[0m19:55:16.720402 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 11.29 seconds (11.29s).
[0m19:55:16.721695 [debug] [MainThread]: Command end result
[0m19:55:16.731198 [info ] [MainThread]: 
[0m19:55:16.732047 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:55:16.732554 [info ] [MainThread]: 
[0m19:55:16.733068 [error] [MainThread]:   Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
[0m19:55:16.733566 [info ] [MainThread]: 
[0m19:55:16.734096 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m19:55:16.734895 [debug] [MainThread]: Command `dbt run` failed at 19:55:16.734760 after 12.51 seconds
[0m19:55:16.735414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806996ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806288f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80616fece0>]}
[0m19:55:16.735933 [debug] [MainThread]: Flushing usage events
[0m19:57:52.927618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7aa71cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc78fa6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc78fa6f20>]}


============================== 19:57:52.932232 | 69dae68e-07de-4c0f-9f1b-117d30ab04d6 ==============================
[0m19:57:52.932232 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:57:52.932954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kj/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:53.149110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69dae68e-07de-4c0f-9f1b-117d30ab04d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc78fa6560>]}
[0m19:57:53.166587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69dae68e-07de-4c0f-9f1b-117d30ab04d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc73a1b430>]}
[0m19:57:53.167435 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m19:57:53.176272 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:57:53.185087 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:57:53.185754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '69dae68e-07de-4c0f-9f1b-117d30ab04d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc73a18f40>]}
[0m19:57:54.118461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69dae68e-07de-4c0f-9f1b-117d30ab04d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc728dc0d0>]}
[0m19:57:54.128992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69dae68e-07de-4c0f-9f1b-117d30ab04d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc73a19720>]}
[0m19:57:54.129746 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m19:57:54.130239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69dae68e-07de-4c0f-9f1b-117d30ab04d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc78fa6cb0>]}
[0m19:57:54.131843 [info ] [MainThread]: 
[0m19:57:54.132782 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:57:54.134223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:57:54.147872 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:57:54.148539 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:57:54.148998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:56.177663 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.0 seconds
[0m19:57:56.179262 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:57:57.664674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m19:57:57.673123 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m19:57:57.673635 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m19:57:57.674068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:58.309590 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m19:57:58.317871 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m19:57:58.563624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69dae68e-07de-4c0f-9f1b-117d30ab04d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc726fe0e0>]}
[0m19:57:58.566653 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:58.568901 [info ] [MainThread]: 
[0m19:57:58.576546 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:57:58.577823 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt.cumulative_orders_by_date ..................... [RUN]
[0m19:57:58.579453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m19:57:58.580463 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m19:57:58.591874 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:57:58.593224 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 19:57:58.581285 => 19:57:58.592847
[0m19:57:58.593979 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m19:57:58.629145 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:57:58.630631 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m19:57:58.631221 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace transient table ANALYTICS.dbt.cumulative_orders_by_date
         as
        (SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
        );
[0m19:57:58.631824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:00.442103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:58:00.489661 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 19:57:58.594523 => 19:58:00.489428
[0m19:58:00.490249 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m19:58:00.703510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69dae68e-07de-4c0f-9f1b-117d30ab04d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc71adf760>]}
[0m19:58:00.705847 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbt.cumulative_orders_by_date ................ [[32mSUCCESS 1[0m in 2.12s]
[0m19:58:00.706739 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m19:58:00.707454 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m19:58:00.708252 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m19:58:00.709222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m19:58:00.709844 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m19:58:00.715716 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m19:58:00.717366 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 19:58:00.710371 => 19:58:00.716962
[0m19:58:00.718012 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m19:58:00.762408 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:58:00.763372 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m19:58:00.764023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:01.620824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:58:01.630595 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:58:01.631281 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m19:58:01.820119 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:58:01.828329 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:58:01.829641 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m19:58:02.003588 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:58:02.013185 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:58:02.013845 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m19:58:02.189590 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m19:58:02.221890 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m19:58:02.224519 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:58:02.225274 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m19:58:02.412500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:58:02.413273 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:58:02.413957 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m19:58:03.017399 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m19:58:03.018215 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:58:03.018777 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m19:58:03.249348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:58:03.261761 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m19:58:03.262456 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m19:58:03.450183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:58:03.462326 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 19:58:00.718497 => 19:58:03.461231
[0m19:58:03.463957 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m19:58:03.685279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69dae68e-07de-4c0f-9f1b-117d30ab04d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc71b653c0>]}
[0m19:58:03.686234 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 2.98s]
[0m19:58:03.687114 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m19:58:03.687808 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m19:58:03.688553 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m19:58:03.689466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m19:58:03.690006 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m19:58:03.695105 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 19:58:03.690453 => 19:58:03.694818
[0m19:58:03.697230 [debug] [Thread-1 (]: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
[0m19:58:03.697900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69dae68e-07de-4c0f-9f1b-117d30ab04d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc71b67610>]}
[0m19:58:03.698714 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model dbt.first_model .......................... [[31mERROR[0m in 0.01s]
[0m19:58:03.699544 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m19:58:03.700212 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:58:03.701273 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m19:58:03.702476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m19:58:03.703089 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m19:58:03.706746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:58:03.708407 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 19:58:03.703559 => 19:58:03.707906
[0m19:58:03.709124 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m19:58:03.717074 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:58:03.719083 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m19:58:03.719811 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m19:58:03.721071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:05.801735 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:58:05.804996 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 19:58:03.709636 => 19:58:05.804772
[0m19:58:05.805520 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m19:58:06.142609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69dae68e-07de-4c0f-9f1b-117d30ab04d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc70196470>]}
[0m19:58:06.146055 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 2.44s]
[0m19:58:06.146967 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m19:58:06.147635 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m19:58:06.148235 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m19:58:06.149195 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m19:58:06.151357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:06.151833 [debug] [MainThread]: Connection 'model.dbt_test_snow.snowflake_customer_purchases' was properly closed.
[0m19:58:06.152366 [info ] [MainThread]: 
[0m19:58:06.152989 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 12.02 seconds (12.02s).
[0m19:58:06.154374 [debug] [MainThread]: Command end result
[0m19:58:06.163396 [info ] [MainThread]: 
[0m19:58:06.164185 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:58:06.164800 [info ] [MainThread]: 
[0m19:58:06.165342 [error] [MainThread]:   Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
[0m19:58:06.165895 [info ] [MainThread]: 
[0m19:58:06.166432 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m19:58:06.167289 [debug] [MainThread]: Command `dbt run` failed at 19:58:06.167165 after 13.25 seconds
[0m19:58:06.167829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7aa71cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc73a76f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc726fe1a0>]}
[0m19:58:06.168364 [debug] [MainThread]: Flushing usage events
[0m20:03:22.718418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d61171db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5f6ae470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5f6ae410>]}


============================== 20:03:22.722956 | aa6a353d-7457-456b-ac46-8d9b498568e1 ==============================
[0m20:03:22.722956 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:03:22.723594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kj/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:03:22.943655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa6a353d-7457-456b-ac46-8d9b498568e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5f6ae5c0>]}
[0m20:03:22.962342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa6a353d-7457-456b-ac46-8d9b498568e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5a11b3d0>]}
[0m20:03:22.963196 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:03:22.972733 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:03:22.981448 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:03:22.982113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa6a353d-7457-456b-ac46-8d9b498568e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5a118fa0>]}
[0m20:03:23.906248 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_test_snow.example.vars
[0m20:03:23.911402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa6a353d-7457-456b-ac46-8d9b498568e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d58fd7fd0>]}
[0m20:03:23.923128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa6a353d-7457-456b-ac46-8d9b498568e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5a11bbb0>]}
[0m20:03:23.923781 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:03:23.924437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa6a353d-7457-456b-ac46-8d9b498568e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5ba8d8a0>]}
[0m20:03:23.926054 [info ] [MainThread]: 
[0m20:03:23.926928 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:03:23.928518 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:03:23.945106 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:03:23.945757 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:03:23.946290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:25.058466 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:03:25.060065 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:03:25.298956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m20:03:25.318186 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m20:03:25.319159 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m20:03:25.319952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:03:26.105185 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m20:03:26.106987 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m20:03:26.429288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa6a353d-7457-456b-ac46-8d9b498568e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d58fe6b00>]}
[0m20:03:26.430316 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:03:26.430921 [info ] [MainThread]: 
[0m20:03:26.434325 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:03:26.434943 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt.cumulative_orders_by_date ..................... [RUN]
[0m20:03:26.435843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m20:03:26.436542 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m20:03:26.444544 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:03:26.445763 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 20:03:26.436922 => 20:03:26.445391
[0m20:03:26.446389 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m20:03:26.482948 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:03:26.485061 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:03:26.486102 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace transient table ANALYTICS.dbt.cumulative_orders_by_date
         as
        (SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
        );
[0m20:03:26.486775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:28.759178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:28.781969 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 20:03:26.446795 => 20:03:28.781753
[0m20:03:28.782549 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m20:03:29.486172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa6a353d-7457-456b-ac46-8d9b498568e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d583183d0>]}
[0m20:03:29.487072 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbt.cumulative_orders_by_date ................ [[32mSUCCESS 1[0m in 3.05s]
[0m20:03:29.487938 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:03:29.488662 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m20:03:29.489273 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m20:03:29.490126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m20:03:29.490682 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m20:03:29.496053 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m20:03:29.497558 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 20:03:29.491072 => 20:03:29.497142
[0m20:03:29.498070 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m20:03:29.540116 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:29.540859 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m20:03:29.541320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:30.746288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:03:30.762762 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:30.763556 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m20:03:30.918384 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:03:30.936374 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:30.937892 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m20:03:31.082177 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:03:31.091310 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:31.091931 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m20:03:31.240463 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:03:31.290637 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m20:03:31.293219 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:31.293738 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m20:03:31.450176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:03:31.451027 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:31.451812 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m20:03:32.034848 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:03:32.037665 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:32.039675 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m20:03:32.216943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:03:32.237912 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:32.238671 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m20:03:32.393575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:03:32.397529 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 20:03:29.498428 => 20:03:32.397302
[0m20:03:32.398073 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m20:03:32.606244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa6a353d-7457-456b-ac46-8d9b498568e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5831bc40>]}
[0m20:03:32.608849 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 3.12s]
[0m20:03:32.611215 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m20:03:32.613194 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m20:03:32.614871 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m20:03:32.617357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m20:03:32.618905 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m20:03:32.626764 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 20:03:32.619759 => 20:03:32.626329
[0m20:03:32.629671 [debug] [Thread-1 (]: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
[0m20:03:32.630422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa6a353d-7457-456b-ac46-8d9b498568e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d583180a0>]}
[0m20:03:32.631363 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model dbt.first_model .......................... [[31mERROR[0m in 0.01s]
[0m20:03:32.632364 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m20:03:32.633223 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:03:32.634053 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m20:03:32.635208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m20:03:32.636449 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m20:03:32.640241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:03:32.641444 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 20:03:32.636933 => 20:03:32.641112
[0m20:03:32.642008 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m20:03:32.647404 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:03:32.649164 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:03:32.650134 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m20:03:32.651072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:34.005755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:03:34.012863 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 20:03:32.642419 => 20:03:34.012194
[0m20:03:34.014028 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m20:03:34.232002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa6a353d-7457-456b-ac46-8d9b498568e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d583184c0>]}
[0m20:03:34.235498 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 1.60s]
[0m20:03:34.238244 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:03:34.239900 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m20:03:34.241915 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m20:03:34.243198 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m20:03:34.247586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:34.248361 [debug] [MainThread]: Connection 'model.dbt_test_snow.snowflake_customer_purchases' was properly closed.
[0m20:03:34.249642 [info ] [MainThread]: 
[0m20:03:34.250718 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m20:03:34.252823 [debug] [MainThread]: Command end result
[0m20:03:34.263849 [info ] [MainThread]: 
[0m20:03:34.264603 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:03:34.265294 [info ] [MainThread]: 
[0m20:03:34.265898 [error] [MainThread]:   Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
[0m20:03:34.266491 [info ] [MainThread]: 
[0m20:03:34.267061 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m20:03:34.267955 [debug] [MainThread]: Command `dbt run` failed at 20:03:34.267818 after 11.56 seconds
[0m20:03:34.268579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d61171db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5a176fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5a11bbb0>]}
[0m20:03:34.269108 [debug] [MainThread]: Flushing usage events
[0m20:03:47.105817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fa471cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f89a6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f89a63b0>]}


============================== 20:03:47.110201 | db57b8e3-36aa-422d-bdac-4f2763696130 ==============================
[0m20:03:47.110201 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:03:47.110841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kj/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:03:47.324890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db57b8e3-36aa-422d-bdac-4f2763696130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f89a6560>]}
[0m20:03:47.343203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db57b8e3-36aa-422d-bdac-4f2763696130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f3417430>]}
[0m20:03:47.344101 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:03:47.353215 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:03:47.361490 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:03:47.362103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'db57b8e3-36aa-422d-bdac-4f2763696130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f3414f40>]}
[0m20:03:48.288729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db57b8e3-36aa-422d-bdac-4f2763696130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f22d7ee0>]}
[0m20:03:48.299484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db57b8e3-36aa-422d-bdac-4f2763696130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f3415720>]}
[0m20:03:48.300186 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:03:48.300804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db57b8e3-36aa-422d-bdac-4f2763696130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f89a6b00>]}
[0m20:03:48.302373 [info ] [MainThread]: 
[0m20:03:48.303216 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:03:48.304717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:03:48.319650 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:03:48.320239 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:03:48.320813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:49.394334 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:03:49.402887 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:03:49.732707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m20:03:49.749511 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m20:03:49.750317 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m20:03:49.750986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:03:50.360118 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m20:03:50.363787 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m20:03:50.591174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db57b8e3-36aa-422d-bdac-4f2763696130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f22e2a70>]}
[0m20:03:50.596291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:03:50.598301 [info ] [MainThread]: 
[0m20:03:50.606448 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:03:50.609125 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt.cumulative_orders_by_date ..................... [RUN]
[0m20:03:50.610692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m20:03:50.611714 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m20:03:50.623331 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:03:50.624692 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 20:03:50.612560 => 20:03:50.624178
[0m20:03:50.625351 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m20:03:50.657496 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:03:50.658810 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:03:50.659346 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace transient table ANALYTICS.dbt.cumulative_orders_by_date
         as
        (SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
        );
[0m20:03:50.659826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:52.090828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:03:52.135351 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 20:03:50.625797 => 20:03:52.135130
[0m20:03:52.135959 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m20:03:52.390727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db57b8e3-36aa-422d-bdac-4f2763696130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f16941f0>]}
[0m20:03:52.393804 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbt.cumulative_orders_by_date ................ [[32mSUCCESS 1[0m in 1.78s]
[0m20:03:52.396430 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:03:52.398296 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m20:03:52.400132 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m20:03:52.402260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m20:03:52.403252 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m20:03:52.412863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m20:03:52.414420 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 20:03:52.403969 => 20:03:52.413872
[0m20:03:52.415169 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m20:03:52.457334 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:52.457998 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m20:03:52.458491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:53.282574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:03:53.293527 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:53.294157 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m20:03:53.475450 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:03:53.485688 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:53.486309 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m20:03:53.731467 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:03:53.742052 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:53.742719 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m20:03:53.920504 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:03:53.970070 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m20:03:53.972880 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:53.973450 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m20:03:54.166141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:03:54.167347 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:54.168566 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m20:03:55.277427 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:03:55.278875 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:55.279948 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m20:03:55.513375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:03:55.541746 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:03:55.542602 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m20:03:55.722671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:03:55.727572 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 20:03:52.415713 => 20:03:55.727343
[0m20:03:55.728198 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m20:03:55.944642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db57b8e3-36aa-422d-bdac-4f2763696130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f1697d00>]}
[0m20:03:55.945565 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 3.54s]
[0m20:03:55.946433 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m20:03:55.947079 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m20:03:55.948040 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m20:03:55.949020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m20:03:55.949601 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m20:03:55.953165 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:03:55.954585 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 20:03:55.949995 => 20:03:55.954136
[0m20:03:55.955185 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m20:03:55.958726 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:03:55.960547 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m20:03:55.961164 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.first_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, True as first_variable
from source_data
where id >= 2

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:03:55.961721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:57.080336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:03:57.085802 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 20:03:55.955670 => 20:03:57.085403
[0m20:03:57.086682 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m20:03:57.314389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db57b8e3-36aa-422d-bdac-4f2763696130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f16828f0>]}
[0m20:03:57.315535 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt.first_model .............................. [[32mSUCCESS 1[0m in 1.37s]
[0m20:03:57.316659 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m20:03:57.317683 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:03:57.318944 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m20:03:57.320086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m20:03:57.320918 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m20:03:57.325952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:03:57.327501 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 20:03:57.321403 => 20:03:57.327068
[0m20:03:57.328095 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m20:03:57.331629 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:03:57.333458 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:03:57.334044 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m20:03:57.334568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:58.938158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:58.941614 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 20:03:57.328497 => 20:03:58.941383
[0m20:03:58.942233 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m20:03:59.261111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db57b8e3-36aa-422d-bdac-4f2763696130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f0448670>]}
[0m20:03:59.261968 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 1.94s]
[0m20:03:59.263075 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:03:59.263663 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m20:03:59.264330 [info ] [Thread-1 (]: 5 of 5 START sql table model dbt.my_second_dbt_model ........................... [RUN]
[0m20:03:59.265670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.snowflake_customer_purchases, now model.dbt_test_snow.my_second_dbt_model)
[0m20:03:59.266222 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_second_dbt_model
[0m20:03:59.271649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_second_dbt_model"
[0m20:03:59.272900 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (compile): 20:03:59.266598 => 20:03:59.272429
[0m20:03:59.273427 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_second_dbt_model
[0m20:03:59.276534 [debug] [Thread-1 (]: Dropping relation "ANALYTICS"."DBT"."MY_SECOND_DBT_MODEL" because it is of type view
[0m20:03:59.280259 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_second_dbt_model"
[0m20:03:59.280977 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_second_dbt_model"} */
drop view if exists "ANALYTICS"."DBT"."MY_SECOND_DBT_MODEL" cascade
[0m20:03:59.281465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:59.857773 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:03:59.861651 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_second_dbt_model"
[0m20:03:59.863249 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_second_dbt_model"
[0m20:03:59.863810 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_second_dbt_model"} */
create or replace transient table ANALYTICS.dbt.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from ANALYTICS.dbt.first_model
where id = 1
        );
[0m20:04:00.253938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:04:00.257229 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (execute): 20:03:59.273816 => 20:04:00.257025
[0m20:04:00.257829 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: Close
[0m20:04:00.478347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db57b8e3-36aa-422d-bdac-4f2763696130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f16830a0>]}
[0m20:04:00.479242 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dbt.my_second_dbt_model ...................... [[32mSUCCESS 1[0m in 1.21s]
[0m20:04:00.480100 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m20:04:00.482471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:00.483009 [debug] [MainThread]: Connection 'model.dbt_test_snow.my_second_dbt_model' was properly closed.
[0m20:04:00.483494 [info ] [MainThread]: 
[0m20:04:00.484075 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 12.18 seconds (12.18s).
[0m20:04:00.485754 [debug] [MainThread]: Command end result
[0m20:04:00.495050 [info ] [MainThread]: 
[0m20:04:00.495840 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:04:00.496491 [info ] [MainThread]: 
[0m20:04:00.497192 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:04:00.498111 [debug] [MainThread]: Command `dbt run` succeeded at 20:04:00.497977 after 13.40 seconds
[0m20:04:00.498622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fa471cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f339b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f224e470>]}
[0m20:04:00.499136 [debug] [MainThread]: Flushing usage events
[0m20:05:41.897719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1fe51db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1e25a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1e25af80>]}


============================== 20:05:41.902419 | 0f732dbc-5b8a-49bb-b7d7-8d2589f5874f ==============================
[0m20:05:41.902419 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:05:41.903087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kj/.dbt', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:05:42.127492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f732dbc-5b8a-49bb-b7d7-8d2589f5874f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1e25a5c0>]}
[0m20:05:42.146341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f732dbc-5b8a-49bb-b7d7-8d2589f5874f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c18fcb3d0>]}
[0m20:05:42.147200 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:05:42.156139 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:05:42.165316 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:05:42.165989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f732dbc-5b8a-49bb-b7d7-8d2589f5874f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c18fc8fa0>]}
[0m20:05:43.062732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f732dbc-5b8a-49bb-b7d7-8d2589f5874f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c13b93fd0>]}
[0m20:05:43.073548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f732dbc-5b8a-49bb-b7d7-8d2589f5874f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c18fcbbb0>]}
[0m20:05:43.074207 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:05:43.074769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f732dbc-5b8a-49bb-b7d7-8d2589f5874f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c18fad8a0>]}
[0m20:05:43.076417 [info ] [MainThread]: 
[0m20:05:43.077402 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:43.078863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:05:43.093024 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:05:43.093597 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:05:43.094057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:44.152443 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:05:44.159888 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:05:44.396789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m20:05:44.405128 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m20:05:44.405655 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m20:05:44.406085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:45.048903 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m20:05:45.055403 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m20:05:45.303700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f732dbc-5b8a-49bb-b7d7-8d2589f5874f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c13ba2a10>]}
[0m20:05:45.304779 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:05:45.305340 [info ] [MainThread]: 
[0m20:05:45.308935 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:05:45.309662 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt.cumulative_orders_by_date ..................... [RUN]
[0m20:05:45.310583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m20:05:45.311147 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m20:05:45.320965 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:05:45.322388 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 20:05:45.311517 => 20:05:45.321985
[0m20:05:45.323050 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m20:05:45.360088 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:05:45.361572 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:05:45.362139 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace transient table ANALYTICS.dbt.cumulative_orders_by_date
         as
        (SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
        );
[0m20:05:45.362609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:47.253603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:05:47.276312 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 20:05:45.323475 => 20:05:47.276084
[0m20:05:47.277026 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m20:05:47.457395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f732dbc-5b8a-49bb-b7d7-8d2589f5874f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c12f583d0>]}
[0m20:05:47.458293 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbt.cumulative_orders_by_date ................ [[32mSUCCESS 1[0m in 2.15s]
[0m20:05:47.459090 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:05:47.459647 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m20:05:47.460297 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m20:05:47.461234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m20:05:47.461711 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m20:05:47.467238 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m20:05:47.468501 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 20:05:47.462083 => 20:05:47.467987
[0m20:05:47.469065 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m20:05:47.512199 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:05:47.513205 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m20:05:47.513734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:48.308386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:05:48.319272 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:05:48.319850 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m20:05:48.506060 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:05:48.515321 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:05:48.516469 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m20:05:48.685698 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:05:48.701599 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:05:48.702437 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m20:05:48.872270 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:05:48.905182 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m20:05:48.907717 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:05:48.908284 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m20:05:49.111514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:05:49.113747 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:05:49.115619 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m20:05:49.915093 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:05:49.916269 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:05:49.917421 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m20:05:50.141470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:05:50.155024 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:05:50.155696 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m20:05:50.359668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:05:50.370857 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 20:05:47.469415 => 20:05:50.370233
[0m20:05:50.372420 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m20:05:50.577859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f732dbc-5b8a-49bb-b7d7-8d2589f5874f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c12f5bc40>]}
[0m20:05:50.579304 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 3.12s]
[0m20:05:50.580969 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m20:05:50.582062 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m20:05:50.583275 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m20:05:50.584978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m20:05:50.585943 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m20:05:50.592290 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:05:50.594010 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 20:05:50.586683 => 20:05:50.593530
[0m20:05:50.594832 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m20:05:50.599497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:05:50.601205 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m20:05:50.601872 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.first_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, True as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:05:50.602489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:51.513918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:05:51.517237 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 20:05:50.595420 => 20:05:51.517019
[0m20:05:51.517770 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m20:05:51.748208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f732dbc-5b8a-49bb-b7d7-8d2589f5874f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c11656bc0>]}
[0m20:05:51.751968 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt.first_model .............................. [[32mSUCCESS 1[0m in 1.16s]
[0m20:05:51.755027 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m20:05:51.757221 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:05:51.758990 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m20:05:51.761132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m20:05:51.763162 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m20:05:51.770889 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:05:51.772838 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 20:05:51.763952 => 20:05:51.772022
[0m20:05:51.773589 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m20:05:51.778238 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:05:51.779857 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:05:51.780473 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m20:05:51.781182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:53.361151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:05:53.365086 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 20:05:51.774086 => 20:05:53.364850
[0m20:05:53.365761 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m20:05:53.577983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f732dbc-5b8a-49bb-b7d7-8d2589f5874f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1150a440>]}
[0m20:05:53.578947 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 1.82s]
[0m20:05:53.579802 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:05:53.580401 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m20:05:53.581107 [info ] [Thread-1 (]: 5 of 5 START sql table model dbt.my_second_dbt_model ........................... [RUN]
[0m20:05:53.581977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.snowflake_customer_purchases, now model.dbt_test_snow.my_second_dbt_model)
[0m20:05:53.582641 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_second_dbt_model
[0m20:05:53.585942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_second_dbt_model"
[0m20:05:53.587218 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (compile): 20:05:53.583035 => 20:05:53.586928
[0m20:05:53.588092 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_second_dbt_model
[0m20:05:53.591619 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_second_dbt_model"
[0m20:05:53.592887 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_second_dbt_model"
[0m20:05:53.593403 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_second_dbt_model"} */
create or replace transient table ANALYTICS.dbt.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from ANALYTICS.dbt.first_model
where id = 1
        );
[0m20:05:53.593923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:54.487757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:05:54.491373 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (execute): 20:05:53.588539 => 20:05:54.491165
[0m20:05:54.491935 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: Close
[0m20:05:54.817839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f732dbc-5b8a-49bb-b7d7-8d2589f5874f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c11508760>]}
[0m20:05:54.820077 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dbt.my_second_dbt_model ...................... [[32mSUCCESS 1[0m in 1.24s]
[0m20:05:54.822978 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m20:05:54.829259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:54.829823 [debug] [MainThread]: Connection 'model.dbt_test_snow.my_second_dbt_model' was properly closed.
[0m20:05:54.830338 [info ] [MainThread]: 
[0m20:05:54.830878 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 11.75 seconds (11.75s).
[0m20:05:54.832369 [debug] [MainThread]: Command end result
[0m20:05:54.841754 [info ] [MainThread]: 
[0m20:05:54.842526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:54.843055 [info ] [MainThread]: 
[0m20:05:54.843569 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:05:54.844388 [debug] [MainThread]: Command `dbt run` succeeded at 20:05:54.844265 after 12.96 seconds
[0m20:05:54.845001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1fe51db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c18dbece0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c18d4c940>]}
[0m20:05:54.845521 [debug] [MainThread]: Flushing usage events
[0m20:08:03.849572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ccd71cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78cb1aa440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78cb1aa3e0>]}


============================== 20:08:03.854277 | b178bfb5-cc8c-4c28-9860-8db514f81274 ==============================
[0m20:08:03.854277 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:08:03.854953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kj/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:08:04.099890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b178bfb5-cc8c-4c28-9860-8db514f81274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78cb1aa590>]}
[0m20:08:04.117704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b178bfb5-cc8c-4c28-9860-8db514f81274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c5c1b280>]}
[0m20:08:04.118586 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:08:04.127115 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:08:04.152792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:08:04.153679 [debug] [MainThread]: Partial parsing: updated file: dbt_test_snow://models/example/my_first_dbt_model.sql
[0m20:08:04.248012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b178bfb5-cc8c-4c28-9860-8db514f81274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c5a9bd60>]}
[0m20:08:04.258981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b178bfb5-cc8c-4c28-9860-8db514f81274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c5bcf1c0>]}
[0m20:08:04.259772 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:08:04.260421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b178bfb5-cc8c-4c28-9860-8db514f81274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c5bcf160>]}
[0m20:08:04.262080 [info ] [MainThread]: 
[0m20:08:04.263088 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:08:04.264681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:08:04.278783 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:08:04.279393 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:08:04.279844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:05.252696 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:08:05.254936 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:08:05.484658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m20:08:05.493733 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m20:08:05.494321 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m20:08:05.494835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:06.078224 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m20:08:06.080441 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m20:08:06.274419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b178bfb5-cc8c-4c28-9860-8db514f81274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c5a44400>]}
[0m20:08:06.275424 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:08:06.276023 [info ] [MainThread]: 
[0m20:08:06.279488 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:08:06.280302 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt.cumulative_orders_by_date ..................... [RUN]
[0m20:08:06.281234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m20:08:06.281806 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m20:08:06.289747 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:08:06.291040 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 20:08:06.282242 => 20:08:06.290593
[0m20:08:06.291654 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m20:08:06.328412 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:08:06.329741 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:08:06.330276 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace transient table ANALYTICS.dbt.cumulative_orders_by_date
         as
        (SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
        );
[0m20:08:06.330775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:08.321883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:08:08.345207 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 20:08:06.292049 => 20:08:08.344970
[0m20:08:08.345835 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m20:08:08.591823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b178bfb5-cc8c-4c28-9860-8db514f81274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c5abded0>]}
[0m20:08:08.592694 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbt.cumulative_orders_by_date ................ [[32mSUCCESS 1[0m in 2.31s]
[0m20:08:08.593778 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:08:08.594505 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m20:08:08.595152 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m20:08:08.596213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m20:08:08.596933 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m20:08:08.606620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m20:08:08.607625 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 20:08:08.597363 => 20:08:08.607391
[0m20:08:08.608254 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m20:08:08.672357 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:08:08.673074 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m20:08:08.673573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:09.388341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:08:09.398811 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:08:09.399536 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m20:08:09.575072 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:08:09.580821 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:08:09.581712 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m20:08:09.754689 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:08:09.765764 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:08:09.766550 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m20:08:09.945645 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:08:09.982238 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m20:08:09.984613 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:08:09.985251 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m20:08:10.171002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:08:10.171641 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:08:10.172227 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m20:08:10.771255 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:08:10.772237 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:08:10.772940 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m20:08:10.998502 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:08:11.022360 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:08:11.023179 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m20:08:11.122684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:08:11.126170 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 20:08:08.608622 => 20:08:11.125932
[0m20:08:11.126960 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m20:08:11.350855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b178bfb5-cc8c-4c28-9860-8db514f81274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78bfdacf40>]}
[0m20:08:11.353363 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 2.75s]
[0m20:08:11.355684 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m20:08:11.357297 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m20:08:11.358794 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m20:08:11.361214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m20:08:11.362800 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m20:08:11.369116 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:08:11.371097 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 20:08:11.363675 => 20:08:11.370649
[0m20:08:11.371828 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m20:08:11.376229 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:08:11.378155 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m20:08:11.378860 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.first_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

/*
select *, True as first_variable
from source_data
where id >= 1
*/

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:08:11.379531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:12.258395 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01afc348-0000-080b-0000-00009b834231
[0m20:08:12.261981 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 32 at position 8 unexpected ')'.
[0m20:08:12.265757 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 20:08:11.372511 => 20:08:12.264346
[0m20:08:12.268077 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m20:08:12.600534 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 32 at position 8 unexpected ')'.
  compiled Code at target/run/dbt_test_snow/models/example/my_first_dbt_model.sql
[0m20:08:12.601402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b178bfb5-cc8c-4c28-9860-8db514f81274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78bfdb79a0>]}
[0m20:08:12.602174 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model dbt.first_model .......................... [[31mERROR[0m in 1.24s]
[0m20:08:12.603001 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m20:08:12.603638 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:08:12.604344 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m20:08:12.605889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m20:08:12.606485 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m20:08:12.610050 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:08:12.611879 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 20:08:12.606937 => 20:08:12.611220
[0m20:08:12.612510 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m20:08:12.615952 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:08:12.617791 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:08:12.618432 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m20:08:12.619027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:14.129701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:08:14.133917 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 20:08:12.613098 => 20:08:14.133644
[0m20:08:14.134622 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m20:08:14.316489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b178bfb5-cc8c-4c28-9860-8db514f81274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78bfd37640>]}
[0m20:08:14.317428 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 1.71s]
[0m20:08:14.318349 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:08:14.319026 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m20:08:14.319688 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m20:08:14.320538 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m20:08:14.322731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:14.323213 [debug] [MainThread]: Connection 'model.dbt_test_snow.snowflake_customer_purchases' was properly closed.
[0m20:08:14.323752 [info ] [MainThread]: 
[0m20:08:14.324397 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 10.06 seconds (10.06s).
[0m20:08:14.326227 [debug] [MainThread]: Command end result
[0m20:08:14.336478 [info ] [MainThread]: 
[0m20:08:14.337220 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:08:14.337740 [info ] [MainThread]: 
[0m20:08:14.338278 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 32 at position 8 unexpected ')'.
  compiled Code at target/run/dbt_test_snow/models/example/my_first_dbt_model.sql
[0m20:08:14.338816 [info ] [MainThread]: 
[0m20:08:14.339415 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m20:08:14.340359 [debug] [MainThread]: Command `dbt run` failed at 20:08:14.340129 after 10.50 seconds
[0m20:08:14.340903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ccd71cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c5bce8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c5bce650>]}
[0m20:08:14.341479 [debug] [MainThread]: Flushing usage events
[0m20:09:44.400721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287b06dcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28795a6440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28795a63e0>]}


============================== 20:09:44.405332 | 55b774f8-f1a4-413d-9291-00b115d6a7c8 ==============================
[0m20:09:44.405332 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:09:44.406015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kj/.dbt', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:09:44.631720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55b774f8-f1a4-413d-9291-00b115d6a7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28795a6590>]}
[0m20:09:44.650338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55b774f8-f1a4-413d-9291-00b115d6a7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286ff13280>]}
[0m20:09:44.651165 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:09:44.659682 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:09:44.685267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:44.686106 [debug] [MainThread]: Partial parsing: updated file: dbt_test_snow://models/example/my_first_dbt_model.sql
[0m20:09:44.781515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55b774f8-f1a4-413d-9291-00b115d6a7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286fd87d60>]}
[0m20:09:44.791912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55b774f8-f1a4-413d-9291-00b115d6a7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286fe0b1c0>]}
[0m20:09:44.792606 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:09:44.793212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55b774f8-f1a4-413d-9291-00b115d6a7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286fe0b160>]}
[0m20:09:44.794753 [info ] [MainThread]: 
[0m20:09:44.795636 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:09:44.797154 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:09:44.811169 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:09:44.811802 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:09:44.812335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:45.982115 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:09:45.985925 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:09:46.222384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m20:09:46.231123 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m20:09:46.231698 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m20:09:46.232124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:09:46.799501 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m20:09:46.801566 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m20:09:46.994625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55b774f8-f1a4-413d-9291-00b115d6a7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28789cb010>]}
[0m20:09:46.996153 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:09:46.997249 [info ] [MainThread]: 
[0m20:09:47.002256 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:09:47.003288 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt.cumulative_orders_by_date ..................... [RUN]
[0m20:09:47.004684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m20:09:47.005795 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m20:09:47.016328 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:09:47.017810 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 20:09:47.006462 => 20:09:47.017400
[0m20:09:47.018472 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m20:09:47.050777 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:09:47.052390 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:09:47.053132 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace transient table ANALYTICS.dbt.cumulative_orders_by_date
         as
        (SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
        );
[0m20:09:47.053653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:49.275911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:09:49.315951 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 20:09:47.018967 => 20:09:49.315731
[0m20:09:49.316514 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m20:09:49.640630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b774f8-f1a4-413d-9291-00b115d6a7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286fe0b220>]}
[0m20:09:49.644361 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbt.cumulative_orders_by_date ................ [[32mSUCCESS 1[0m in 2.64s]
[0m20:09:49.647333 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:09:49.649211 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m20:09:49.650664 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m20:09:49.652777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m20:09:49.654634 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m20:09:49.668319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m20:09:49.669718 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 20:09:49.655421 => 20:09:49.669294
[0m20:09:49.670369 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m20:09:49.721752 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:09:49.722385 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m20:09:49.722890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:50.455688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:09:50.480022 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:09:50.481089 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m20:09:50.668743 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:09:50.684861 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:09:50.685962 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m20:09:50.877986 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:09:50.888375 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:09:50.889094 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m20:09:51.057761 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:09:51.110640 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m20:09:51.113147 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:09:51.113674 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m20:09:51.325607 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:09:51.326613 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:09:51.327611 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m20:09:51.952205 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:09:51.953080 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:09:51.953616 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m20:09:52.183246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:09:52.215764 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:09:52.216500 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m20:09:52.423279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:09:52.426456 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 20:09:49.670854 => 20:09:52.426258
[0m20:09:52.427005 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m20:09:52.738177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b774f8-f1a4-413d-9291-00b115d6a7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286e38cac0>]}
[0m20:09:52.738989 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 3.09s]
[0m20:09:52.739817 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m20:09:52.740536 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m20:09:52.741220 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m20:09:52.742055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m20:09:52.742574 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m20:09:52.746129 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:09:52.747225 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 20:09:52.742957 => 20:09:52.746843
[0m20:09:52.747820 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m20:09:52.751133 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:09:52.752531 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m20:09:52.753157 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.first_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)


select *, True as first_variable
from source_data
where id >= 1


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:09:52.753678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:53.796595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:09:53.800081 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 20:09:52.748320 => 20:09:53.799868
[0m20:09:53.800623 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m20:09:54.033859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b774f8-f1a4-413d-9291-00b115d6a7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286e330fd0>]}
[0m20:09:54.034712 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt.first_model .............................. [[32mSUCCESS 1[0m in 1.29s]
[0m20:09:54.035506 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m20:09:54.036093 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:09:54.036796 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m20:09:54.037680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m20:09:54.038187 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m20:09:54.041285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:09:54.042637 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 20:09:54.038587 => 20:09:54.042102
[0m20:09:54.043754 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m20:09:54.047280 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:09:54.048769 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:09:54.049331 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m20:09:54.049875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:55.872792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:09:55.876355 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 20:09:54.044187 => 20:09:55.876135
[0m20:09:55.877016 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m20:09:56.183948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b774f8-f1a4-413d-9291-00b115d6a7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286e317730>]}
[0m20:09:56.185562 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 2.15s]
[0m20:09:56.186385 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:09:56.186960 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m20:09:56.187565 [info ] [Thread-1 (]: 5 of 5 START sql table model dbt.my_second_dbt_model ........................... [RUN]
[0m20:09:56.188485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.snowflake_customer_purchases, now model.dbt_test_snow.my_second_dbt_model)
[0m20:09:56.188996 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_second_dbt_model
[0m20:09:56.192404 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_second_dbt_model"
[0m20:09:56.193876 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (compile): 20:09:56.189436 => 20:09:56.193429
[0m20:09:56.194440 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_second_dbt_model
[0m20:09:56.198054 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_second_dbt_model"
[0m20:09:56.199419 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_second_dbt_model"
[0m20:09:56.199989 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_second_dbt_model"} */
create or replace transient table ANALYTICS.dbt.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from ANALYTICS.dbt.first_model
where id = 1
        );
[0m20:09:56.200697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:57.160152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:09:57.163587 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_second_dbt_model (execute): 20:09:56.194826 => 20:09:57.163368
[0m20:09:57.164224 [debug] [Thread-1 (]: On model.dbt_test_snow.my_second_dbt_model: Close
[0m20:09:57.461435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b774f8-f1a4-413d-9291-00b115d6a7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286caa0d00>]}
[0m20:09:57.462299 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dbt.my_second_dbt_model ...................... [[32mSUCCESS 1[0m in 1.27s]
[0m20:09:57.463117 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m20:09:57.465592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:57.466089 [debug] [MainThread]: Connection 'model.dbt_test_snow.my_second_dbt_model' was properly closed.
[0m20:09:57.466578 [info ] [MainThread]: 
[0m20:09:57.467128 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 12.67 seconds (12.67s).
[0m20:09:57.468923 [debug] [MainThread]: Command end result
[0m20:09:57.482924 [info ] [MainThread]: 
[0m20:09:57.483966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:09:57.484829 [info ] [MainThread]: 
[0m20:09:57.485751 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:09:57.487193 [debug] [MainThread]: Command `dbt run` succeeded at 20:09:57.486990 after 13.10 seconds
[0m20:09:57.487983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287b06dcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286ff13280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286ca8ed40>]}
[0m20:09:57.488856 [debug] [MainThread]: Flushing usage events
[0m20:10:13.483978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cdc71db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cc1aa470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cc1aa410>]}


============================== 20:10:13.488631 | ea1cec56-dc8b-4c05-b0e3-9bb54f050330 ==============================
[0m20:10:13.488631 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:10:13.489366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kj/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:10:13.733006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea1cec56-dc8b-4c05-b0e3-9bb54f050330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cc1aa5c0>]}
[0m20:10:13.751636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea1cec56-dc8b-4c05-b0e3-9bb54f050330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c6c173d0>]}
[0m20:10:13.752564 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:10:13.761548 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:10:13.787138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:10:13.788165 [debug] [MainThread]: Partial parsing: updated file: dbt_test_snow://models/example/my_first_dbt_model.sql
[0m20:10:13.884504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea1cec56-dc8b-4c05-b0e3-9bb54f050330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c6a93d90>]}
[0m20:10:13.895228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea1cec56-dc8b-4c05-b0e3-9bb54f050330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c6bcb1f0>]}
[0m20:10:13.895938 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:10:13.896447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea1cec56-dc8b-4c05-b0e3-9bb54f050330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c6bcb190>]}
[0m20:10:13.898081 [info ] [MainThread]: 
[0m20:10:13.898940 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:13.900387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:10:13.926866 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:10:13.927499 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:10:13.928056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:14.861327 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:10:14.866842 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:10:15.069625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_dbt'
[0m20:10:15.091026 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m20:10:15.092005 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m20:10:15.092970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:15.687493 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m20:10:15.693294 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m20:10:15.920740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea1cec56-dc8b-4c05-b0e3-9bb54f050330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cb5cf040>]}
[0m20:10:15.921729 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:15.922240 [info ] [MainThread]: 
[0m20:10:15.925400 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:10:15.926036 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt.cumulative_orders_by_date ..................... [RUN]
[0m20:10:15.926889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m20:10:15.927376 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m20:10:15.934407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:10:15.936438 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 20:10:15.927761 => 20:10:15.935942
[0m20:10:15.937058 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m20:10:15.971454 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:10:15.973494 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:10:15.974069 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace transient table ANALYTICS.dbt.cumulative_orders_by_date
         as
        (SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
        );
[0m20:10:15.974560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:17.061922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:10:17.083627 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 20:10:15.937437 => 20:10:17.083421
[0m20:10:17.084208 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m20:10:17.412940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea1cec56-dc8b-4c05-b0e3-9bb54f050330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c6bcb190>]}
[0m20:10:17.416210 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbt.cumulative_orders_by_date ................ [[32mSUCCESS 1[0m in 1.49s]
[0m20:10:17.419677 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:10:17.421756 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m20:10:17.423466 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m20:10:17.425647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m20:10:17.426876 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m20:10:17.441918 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m20:10:17.443202 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 20:10:17.427797 => 20:10:17.442904
[0m20:10:17.443924 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m20:10:17.486378 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:10:17.487059 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m20:10:17.487654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:18.347445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:10:18.367468 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:10:18.368667 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m20:10:18.557029 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:10:18.562155 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:10:18.562701 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m20:10:18.743464 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:10:18.768183 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:10:18.769194 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m20:10:18.938822 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:10:18.984007 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m20:10:18.986623 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:10:18.987185 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m20:10:19.188405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:19.189062 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:10:19.189655 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m20:10:19.852179 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:10:19.855770 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:10:19.858741 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m20:10:20.079111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:20.108147 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:10:20.109093 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m20:10:20.296155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:20.300814 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 20:10:17.444467 => 20:10:20.300562
[0m20:10:20.301478 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m20:10:20.515765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea1cec56-dc8b-4c05-b0e3-9bb54f050330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c4ea8dc0>]}
[0m20:10:20.517733 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 3.09s]
[0m20:10:20.518775 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m20:10:20.519421 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m20:10:20.519995 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m20:10:20.520951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m20:10:20.521477 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m20:10:20.525081 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:10:20.526560 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 20:10:20.521838 => 20:10:20.526175
[0m20:10:20.527083 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m20:10:20.530539 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:10:20.531909 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m20:10:20.532678 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.first_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

/*

select *, True as first_variable
from source_data
where id >= 1

*/

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:10:20.533201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:21.154745 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01afc34a-0000-080b-0000-00009b83426d
[0m20:10:21.155392 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 34 at position 8 unexpected ')'.
[0m20:10:21.156277 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 20:10:20.527538 => 20:10:21.155929
[0m20:10:21.156814 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m20:10:21.480885 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 8 unexpected ')'.
  compiled Code at target/run/dbt_test_snow/models/example/my_first_dbt_model.sql
[0m20:10:21.483043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea1cec56-dc8b-4c05-b0e3-9bb54f050330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c4503ca0>]}
[0m20:10:21.485678 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model dbt.first_model .......................... [[31mERROR[0m in 0.96s]
[0m20:10:21.487693 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m20:10:21.489331 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:10:21.490604 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m20:10:21.492426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m20:10:21.493435 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m20:10:21.498785 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:10:21.500740 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 20:10:21.494285 => 20:10:21.500229
[0m20:10:21.501922 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m20:10:21.506372 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:10:21.508456 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:10:21.509224 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m20:10:21.509836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:22.978157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:10:22.982490 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 20:10:21.502485 => 20:10:22.982256
[0m20:10:22.983067 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m20:10:23.298568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea1cec56-dc8b-4c05-b0e3-9bb54f050330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c45031c0>]}
[0m20:10:23.299513 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 1.81s]
[0m20:10:23.300653 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:10:23.301322 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m20:10:23.301910 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m20:10:23.302600 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m20:10:23.304869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:23.305380 [debug] [MainThread]: Connection 'list_ANALYTICS' was properly closed.
[0m20:10:23.306263 [debug] [MainThread]: Connection 'model.dbt_test_snow.snowflake_customer_purchases' was properly closed.
[0m20:10:23.307245 [info ] [MainThread]: 
[0m20:10:23.308298 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m20:10:23.309925 [debug] [MainThread]: Command end result
[0m20:10:23.320033 [info ] [MainThread]: 
[0m20:10:23.320750 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:10:23.321227 [info ] [MainThread]: 
[0m20:10:23.321683 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 8 unexpected ')'.
  compiled Code at target/run/dbt_test_snow/models/example/my_first_dbt_model.sql
[0m20:10:23.322138 [info ] [MainThread]: 
[0m20:10:23.322643 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m20:10:23.323423 [debug] [MainThread]: Command `dbt run` failed at 20:10:23.323297 after 9.85 seconds
[0m20:10:23.323924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cdc71db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c6aadf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c458db70>]}
[0m20:10:23.324544 [debug] [MainThread]: Flushing usage events
[0m20:11:26.971578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa198b55db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa196f5e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa196f5e410>]}


============================== 20:11:26.976067 | 5d018781-1257-45a2-8901-f377eef0f76e ==============================
[0m20:11:26.976067 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:11:26.976821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kj/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kj/Krzys/git/dbt-test/dbt_test_snow/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:11:27.204222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d018781-1257-45a2-8901-f377eef0f76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa196f5e5c0>]}
[0m20:11:27.222793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d018781-1257-45a2-8901-f377eef0f76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19345b3d0>]}
[0m20:11:27.223625 [info ] [MainThread]: Registered adapter: snowflake=1.6.4
[0m20:11:27.232506 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:11:27.258349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:11:27.259306 [debug] [MainThread]: Partial parsing: updated file: dbt_test_snow://models/example/my_first_dbt_model.sql
[0m20:11:27.354748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d018781-1257-45a2-8901-f377eef0f76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa190933eb0>]}
[0m20:11:27.365186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d018781-1257-45a2-8901-f377eef0f76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa191a831f0>]}
[0m20:11:27.365890 [info ] [MainThread]: Found 5 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m20:11:27.366392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d018781-1257-45a2-8901-f377eef0f76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa191a83190>]}
[0m20:11:27.367956 [info ] [MainThread]: 
[0m20:11:27.368893 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:11:27.370283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:11:27.384245 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:11:27.384899 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:11:27.385356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:28.366349 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:11:28.367934 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:11:28.606489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_dbt)
[0m20:11:28.615488 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_dbt"
[0m20:11:28.616171 [debug] [ThreadPool]: On list_ANALYTICS_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "connection_name": "list_ANALYTICS_dbt"} */
show terse objects in ANALYTICS.dbt limit 10000
[0m20:11:28.616602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:29.269603 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m20:11:29.272143 [debug] [ThreadPool]: On list_ANALYTICS_dbt: Close
[0m20:11:29.500945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d018781-1257-45a2-8901-f377eef0f76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa191a99e40>]}
[0m20:11:29.502206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:11:29.502936 [info ] [MainThread]: 
[0m20:11:29.506572 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:11:29.507205 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt.cumulative_orders_by_date ..................... [RUN]
[0m20:11:29.508024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_dbt, now model.dbt_test_snow.cumulative_orders_by_date)
[0m20:11:29.508624 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.cumulative_orders_by_date
[0m20:11:29.515578 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:11:29.517001 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (compile): 20:11:29.509000 => 20:11:29.516550
[0m20:11:29.517562 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.cumulative_orders_by_date
[0m20:11:29.548718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:11:29.550158 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.cumulative_orders_by_date"
[0m20:11:29.550694 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.cumulative_orders_by_date"} */
create or replace transient table ANALYTICS.dbt.cumulative_orders_by_date
         as
        (SELECT DISTINCT
    o_orderdate,
    sum(o_totalprice) OVER (order by o_orderdate) AS cumulative_sales
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
ORDER BY o_orderdate
        );
[0m20:11:29.551245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:31.462033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:11:31.485063 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.cumulative_orders_by_date (execute): 20:11:29.517945 => 20:11:31.484838
[0m20:11:31.485623 [debug] [Thread-1 (]: On model.dbt_test_snow.cumulative_orders_by_date: Close
[0m20:11:31.689754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d018781-1257-45a2-8901-f377eef0f76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1905315a0>]}
[0m20:11:31.693543 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbt.cumulative_orders_by_date ................ [[32mSUCCESS 1[0m in 2.18s]
[0m20:11:31.697331 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.cumulative_orders_by_date
[0m20:11:31.699275 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.dates
[0m20:11:31.701448 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dbt.dates ................................... [RUN]
[0m20:11:31.705519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.cumulative_orders_by_date, now model.dbt_test_snow.dates)
[0m20:11:31.707289 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.dates
[0m20:11:31.722772 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.dates"
[0m20:11:31.724670 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (compile): 20:11:31.708127 => 20:11:31.724195
[0m20:11:31.725312 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.dates
[0m20:11:31.771934 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:11:31.772678 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
create or replace  temporary view ANALYTICS.dbt.dates__dbt_tmp
  
   as (
    

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM
WHERE d_date <= current_date


    and d_date > (SELECT max(d_date) FROM ANALYTICS.dbt.dates )

  );
[0m20:11:31.773546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:32.484054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:11:32.494358 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:11:32.494988 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates__dbt_tmp
[0m20:11:32.679992 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:11:32.697223 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:11:32.698291 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table ANALYTICS.dbt.dates
[0m20:11:32.869057 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:11:32.881615 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:11:32.882448 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
describe table "ANALYTICS"."DBT"."DATES"
[0m20:11:33.058951 [debug] [Thread-1 (]: SQL status: SUCCESS 28 in 0.0 seconds
[0m20:11:33.091789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.dates"
[0m20:11:33.094391 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:11:33.094959 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
-- back compat for old kwarg name
  
  begin;
[0m20:11:33.283781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:11:33.284949 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:11:33.285922 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
merge into ANALYTICS.dbt.dates as DBT_INTERNAL_DEST
        using ANALYTICS.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
            )

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
[0m20:11:33.907128 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:11:33.909367 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:11:33.909910 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
COMMIT
[0m20:11:34.147143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:11:34.174140 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.dates"
[0m20:11:34.174917 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.dates"} */
drop view if exists ANALYTICS.dbt.dates__dbt_tmp cascade
[0m20:11:34.370225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:11:34.377281 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.dates (execute): 20:11:31.728071 => 20:11:34.376776
[0m20:11:34.378622 [debug] [Thread-1 (]: On model.dbt_test_snow.dates: Close
[0m20:11:34.703504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d018781-1257-45a2-8901-f377eef0f76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa190533c70>]}
[0m20:11:34.705310 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dbt.dates .............................. [[32mSUCCESS 0[0m in 3.00s]
[0m20:11:34.706172 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.dates
[0m20:11:34.706791 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_first_dbt_model
[0m20:11:34.707393 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.first_model ................................... [RUN]
[0m20:11:34.708282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.dates, now model.dbt_test_snow.my_first_dbt_model)
[0m20:11:34.708915 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.my_first_dbt_model
[0m20:11:34.712004 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:11:34.713398 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (compile): 20:11:34.709327 => 20:11:34.713032
[0m20:11:34.714008 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.my_first_dbt_model
[0m20:11:34.717573 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.my_first_dbt_model"
[0m20:11:34.718805 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.my_first_dbt_model"
[0m20:11:34.719325 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.my_first_dbt_model"} */
create or replace transient table ANALYTICS.dbt.first_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:11:34.719860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:35.334268 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01afc34b-0000-080c-0000-00009b835251
[0m20:11:35.334861 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 28 at position 8 unexpected ')'.
[0m20:11:35.335562 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.my_first_dbt_model (execute): 20:11:34.714414 => 20:11:35.335338
[0m20:11:35.336158 [debug] [Thread-1 (]: On model.dbt_test_snow.my_first_dbt_model: Close
[0m20:11:35.662037 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 8 unexpected ')'.
  compiled Code at target/run/dbt_test_snow/models/example/my_first_dbt_model.sql
[0m20:11:35.664392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d018781-1257-45a2-8901-f377eef0f76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa190533280>]}
[0m20:11:35.666968 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model dbt.first_model .......................... [[31mERROR[0m in 0.96s]
[0m20:11:35.669437 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_first_dbt_model
[0m20:11:35.670901 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:11:35.672314 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.snowflake_customer_purchases .................. [RUN]
[0m20:11:35.675395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test_snow.my_first_dbt_model, now model.dbt_test_snow.snowflake_customer_purchases)
[0m20:11:35.676943 [debug] [Thread-1 (]: Began compiling node model.dbt_test_snow.snowflake_customer_purchases
[0m20:11:35.682265 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:11:35.683381 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (compile): 20:11:35.677771 => 20:11:35.683068
[0m20:11:35.684105 [debug] [Thread-1 (]: Began executing node model.dbt_test_snow.snowflake_customer_purchases
[0m20:11:35.687532 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:11:35.689192 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_test_snow.snowflake_customer_purchases"
[0m20:11:35.689707 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_test_snow", "target_name": "dev", "node_id": "model.dbt_test_snow.snowflake_customer_purchases"} */
create or replace transient table ANALYTICS.dbt.snowflake_customer_purchases
         as
        (

SELECT c.c_custkey, c.c_name, c.c_nationkey as nation, sum( o.o_totalprice) as total_order_price
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
GROUP BY c.c_custkey, c.c_name, c.c_nationkey
        );
[0m20:11:35.690178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:37.137505 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:11:37.145934 [debug] [Thread-1 (]: Timing info for model.dbt_test_snow.snowflake_customer_purchases (execute): 20:11:35.684476 => 20:11:37.145723
[0m20:11:37.146524 [debug] [Thread-1 (]: On model.dbt_test_snow.snowflake_customer_purchases: Close
[0m20:11:37.459326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d018781-1257-45a2-8901-f377eef0f76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1905335b0>]}
[0m20:11:37.460724 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.snowflake_customer_purchases ............. [[32mSUCCESS 1[0m in 1.78s]
[0m20:11:37.461810 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.snowflake_customer_purchases
[0m20:11:37.462608 [debug] [Thread-1 (]: Began running node model.dbt_test_snow.my_second_dbt_model
[0m20:11:37.463432 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m20:11:37.464362 [debug] [Thread-1 (]: Finished running node model.dbt_test_snow.my_second_dbt_model
[0m20:11:37.467022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:37.467585 [debug] [MainThread]: Connection 'model.dbt_test_snow.snowflake_customer_purchases' was properly closed.
[0m20:11:37.468345 [info ] [MainThread]: 
[0m20:11:37.468988 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 10.10 seconds (10.10s).
[0m20:11:37.470639 [debug] [MainThread]: Command end result
[0m20:11:37.481789 [info ] [MainThread]: 
[0m20:11:37.482530 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:11:37.483053 [info ] [MainThread]: 
[0m20:11:37.483569 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 8 unexpected ')'.
  compiled Code at target/run/dbt_test_snow/models/example/my_first_dbt_model.sql
[0m20:11:37.484211 [info ] [MainThread]: 
[0m20:11:37.484767 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m20:11:37.485583 [debug] [MainThread]: Command `dbt run` failed at 20:11:37.485463 after 10.52 seconds
[0m20:11:37.486057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa198b55db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1902a73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1902a5db0>]}
[0m20:11:37.488191 [debug] [MainThread]: Flushing usage events
